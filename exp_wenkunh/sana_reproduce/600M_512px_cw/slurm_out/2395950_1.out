I0415 00:42:50.181000 2897777 site-packages/torch/distributed/run.py:675] Using nproc_per_node=8.
I0415 00:42:50.191000 1207412 site-packages/torch/distributed/run.py:675] Using nproc_per_node=8.
W0415 00:42:50.181000 2897777 site-packages/torch/distributed/run.py:792] 
W0415 00:42:50.181000 2897777 site-packages/torch/distributed/run.py:792] *****************************************
W0415 00:42:50.181000 2897777 site-packages/torch/distributed/run.py:792] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
W0415 00:42:50.181000 2897777 site-packages/torch/distributed/run.py:792] *****************************************
I0415 00:42:50.181000 2897777 site-packages/torch/distributed/launcher/api.py:194] Starting elastic_operator with launch configs:
I0415 00:42:50.181000 2897777 site-packages/torch/distributed/launcher/api.py:194]   entrypoint       : train_scripts.train
I0415 00:42:50.181000 2897777 site-packages/torch/distributed/launcher/api.py:194]   min_nodes        : 2
I0415 00:42:50.181000 2897777 site-packages/torch/distributed/launcher/api.py:194]   max_nodes        : 2
I0415 00:42:50.181000 2897777 site-packages/torch/distributed/launcher/api.py:194]   nproc_per_node   : 8
I0415 00:42:50.181000 2897777 site-packages/torch/distributed/launcher/api.py:194]   run_id           : 7678
I0415 00:42:50.181000 2897777 site-packages/torch/distributed/launcher/api.py:194]   rdzv_backend     : c10d
I0415 00:42:50.181000 2897777 site-packages/torch/distributed/launcher/api.py:194]   rdzv_endpoint    : 10.65.28.131:29500
I0415 00:42:50.181000 2897777 site-packages/torch/distributed/launcher/api.py:194]   rdzv_configs     : {'timeout': 900}
I0415 00:42:50.181000 2897777 site-packages/torch/distributed/launcher/api.py:194]   max_restarts     : 0
I0415 00:42:50.181000 2897777 site-packages/torch/distributed/launcher/api.py:194]   monitor_interval : 0.1
I0415 00:42:50.181000 2897777 site-packages/torch/distributed/launcher/api.py:194]   log_dir          : /tmp/torchelastic_o4shz57i
I0415 00:42:50.181000 2897777 site-packages/torch/distributed/launcher/api.py:194]   metrics_cfg      : {}
I0415 00:42:50.181000 2897777 site-packages/torch/distributed/launcher/api.py:194] 
I0415 00:42:50.196000 2897777 site-packages/torch/distributed/elastic/agent/server/api.py:860] [default] starting workers for entrypoint: python
I0415 00:42:50.196000 2897777 site-packages/torch/distributed/elastic/agent/server/api.py:677] [default] Rendezvous'ing worker group
W0415 00:42:50.192000 1207412 site-packages/torch/distributed/run.py:792] 
W0415 00:42:50.192000 1207412 site-packages/torch/distributed/run.py:792] *****************************************
W0415 00:42:50.192000 1207412 site-packages/torch/distributed/run.py:792] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
W0415 00:42:50.192000 1207412 site-packages/torch/distributed/run.py:792] *****************************************
I0415 00:42:50.192000 1207412 site-packages/torch/distributed/launcher/api.py:194] Starting elastic_operator with launch configs:
I0415 00:42:50.192000 1207412 site-packages/torch/distributed/launcher/api.py:194]   entrypoint       : train_scripts.train
I0415 00:42:50.192000 1207412 site-packages/torch/distributed/launcher/api.py:194]   min_nodes        : 2
I0415 00:42:50.192000 1207412 site-packages/torch/distributed/launcher/api.py:194]   max_nodes        : 2
I0415 00:42:50.192000 1207412 site-packages/torch/distributed/launcher/api.py:194]   nproc_per_node   : 8
I0415 00:42:50.192000 1207412 site-packages/torch/distributed/launcher/api.py:194]   run_id           : 7678
I0415 00:42:50.192000 1207412 site-packages/torch/distributed/launcher/api.py:194]   rdzv_backend     : c10d
I0415 00:42:50.192000 1207412 site-packages/torch/distributed/launcher/api.py:194]   rdzv_endpoint    : 10.65.28.131:29500
I0415 00:42:50.192000 1207412 site-packages/torch/distributed/launcher/api.py:194]   rdzv_configs     : {'timeout': 900}
I0415 00:42:50.192000 1207412 site-packages/torch/distributed/launcher/api.py:194]   max_restarts     : 0
I0415 00:42:50.192000 1207412 site-packages/torch/distributed/launcher/api.py:194]   monitor_interval : 0.1
I0415 00:42:50.192000 1207412 site-packages/torch/distributed/launcher/api.py:194]   log_dir          : /tmp/torchelastic_z2kuwych
I0415 00:42:50.192000 1207412 site-packages/torch/distributed/launcher/api.py:194]   metrics_cfg      : {}
I0415 00:42:50.192000 1207412 site-packages/torch/distributed/launcher/api.py:194] 
I0415 00:42:50.202000 1207412 site-packages/torch/distributed/elastic/agent/server/api.py:860] [default] starting workers for entrypoint: python
I0415 00:42:50.202000 1207412 site-packages/torch/distributed/elastic/agent/server/api.py:677] [default] Rendezvous'ing worker group
I0415 00:42:51.275000 2897777 site-packages/torch/distributed/elastic/agent/server/api.py:525] [default] Rendezvous complete for workers. Result:
I0415 00:42:51.275000 2897777 site-packages/torch/distributed/elastic/agent/server/api.py:525]   restart_count=0
I0415 00:42:51.275000 2897777 site-packages/torch/distributed/elastic/agent/server/api.py:525]   master_addr=cw-dfw-h100-004-276-012.cm.cluster
I0415 00:42:51.275000 2897777 site-packages/torch/distributed/elastic/agent/server/api.py:525]   master_port=10877
I0415 00:42:51.275000 2897777 site-packages/torch/distributed/elastic/agent/server/api.py:525]   group_rank=0
I0415 00:42:51.275000 2897777 site-packages/torch/distributed/elastic/agent/server/api.py:525]   group_world_size=2
I0415 00:42:51.275000 2897777 site-packages/torch/distributed/elastic/agent/server/api.py:525]   local_ranks=[0, 1, 2, 3, 4, 5, 6, 7]
I0415 00:42:51.275000 2897777 site-packages/torch/distributed/elastic/agent/server/api.py:525]   role_ranks=[0, 1, 2, 3, 4, 5, 6, 7]
I0415 00:42:51.275000 2897777 site-packages/torch/distributed/elastic/agent/server/api.py:525]   global_ranks=[0, 1, 2, 3, 4, 5, 6, 7]
I0415 00:42:51.275000 2897777 site-packages/torch/distributed/elastic/agent/server/api.py:525]   role_world_sizes=[16, 16, 16, 16, 16, 16, 16, 16]
I0415 00:42:51.275000 2897777 site-packages/torch/distributed/elastic/agent/server/api.py:525]   global_world_sizes=[16, 16, 16, 16, 16, 16, 16, 16]
I0415 00:42:51.275000 2897777 site-packages/torch/distributed/elastic/agent/server/api.py:525] 
I0415 00:42:51.275000 2897777 site-packages/torch/distributed/elastic/agent/server/api.py:685] [default] Starting worker group
I0415 00:42:51.272000 1207412 site-packages/torch/distributed/elastic/agent/server/api.py:525] [default] Rendezvous complete for workers. Result:
I0415 00:42:51.272000 1207412 site-packages/torch/distributed/elastic/agent/server/api.py:525]   restart_count=0
I0415 00:42:51.272000 1207412 site-packages/torch/distributed/elastic/agent/server/api.py:525]   master_addr=cw-dfw-h100-004-276-012.cm.cluster
I0415 00:42:51.272000 1207412 site-packages/torch/distributed/elastic/agent/server/api.py:525]   master_port=10877
I0415 00:42:51.272000 1207412 site-packages/torch/distributed/elastic/agent/server/api.py:525]   group_rank=1
I0415 00:42:51.272000 1207412 site-packages/torch/distributed/elastic/agent/server/api.py:525]   group_world_size=2
I0415 00:42:51.272000 1207412 site-packages/torch/distributed/elastic/agent/server/api.py:525]   local_ranks=[0, 1, 2, 3, 4, 5, 6, 7]
I0415 00:42:51.272000 1207412 site-packages/torch/distributed/elastic/agent/server/api.py:525]   role_ranks=[8, 9, 10, 11, 12, 13, 14, 15]
I0415 00:42:51.272000 1207412 site-packages/torch/distributed/elastic/agent/server/api.py:525]   global_ranks=[8, 9, 10, 11, 12, 13, 14, 15]
I0415 00:42:51.272000 1207412 site-packages/torch/distributed/elastic/agent/server/api.py:525]   role_world_sizes=[16, 16, 16, 16, 16, 16, 16, 16]
I0415 00:42:51.272000 1207412 site-packages/torch/distributed/elastic/agent/server/api.py:525]   global_world_sizes=[16, 16, 16, 16, 16, 16, 16, 16]
I0415 00:42:51.272000 1207412 site-packages/torch/distributed/elastic/agent/server/api.py:525] 
I0415 00:42:51.273000 1207412 site-packages/torch/distributed/elastic/agent/server/api.py:685] [default] Starting worker group
I0415 00:42:51.275000 2897777 site-packages/torch/distributed/elastic/agent/server/local_elastic_agent.py:298] use_agent_store: True
I0415 00:42:51.273000 1207412 site-packages/torch/distributed/elastic/agent/server/local_elastic_agent.py:298] use_agent_store: True
I0415 00:42:51.275000 2897777 site-packages/torch/distributed/elastic/agent/server/local_elastic_agent.py:192] Environment variable 'TORCHELASTIC_ENABLE_FILE_TIMER' not found. Do not start FileTimerServer.
I0415 00:42:51.273000 1207412 site-packages/torch/distributed/elastic/agent/server/local_elastic_agent.py:192] Environment variable 'TORCHELASTIC_ENABLE_FILE_TIMER' not found. Do not start FileTimerServer.
I0415 00:42:51.276000 2897777 site-packages/torch/distributed/elastic/agent/server/local_elastic_agent.py:236] Environment variable 'TORCHELASTIC_HEALTH_CHECK_PORT' not found. Do not start health check.
I0415 00:42:51.273000 1207412 site-packages/torch/distributed/elastic/agent/server/local_elastic_agent.py:236] Environment variable 'TORCHELASTIC_HEALTH_CHECK_PORT' not found. Do not start health check.
usage: train.py [-h] [--config_path str] [--work_dir str] [--resume_from str]
                [--load_from str] [--debug str] [--caching str]
                [--report_to str] [--tracker_project_name str] [--name str]
                [--loss_report_name str] [--data.data_dir str]
                [--data.caption_proportion str]
                [--data.external_caption_suffixes str]
                [--data.external_clipscore_suffixes str]
                [--data.clip_thr_temperature str] [--data.clip_thr str]
                [--data.del_img_clip_thr str] [--data.sort_dataset str]
                [--data.load_text_feat str] [--data.load_vae_feat str]
                [--data.transform str] [--data.type str]
                [--data.image_size str] [--data.hq_only str]
                [--data.valid_num str] [--data.data str] [--data.extra str]
                [--model.model str] [--model.teacher str]
                [--model.image_size str] [--model.mixed_precision str]
                [--model.fp32_attention str] [--model.load_from str]
                [--model.discriminator_model str] [--model.teacher_model str]
                [--model.teacher_model_weight_dtype str]
                [--model.resume_from str] [--model.aspect_ratio_type str]
                [--model.multi_scale str] [--model.pe_interpolation str]
                [--model.micro_condition str] [--model.attn_type str]
                [--model.autocast_linear_attn str] [--model.ffn_type str]
                [--model.mlp_acts str] [--model.mlp_ratio str]
                [--model.use_pe str] [--model.pos_embed_type str]
                [--model.qk_norm str] [--model.class_dropout_prob str]
                [--model.linear_head_dim str] [--model.cross_norm str]
                [--model.cross_attn_type str] [--model.logvar str]
                [--model.cfg_scale str] [--model.cfg_embed str]
                [--model.cfg_embed_scale str] [--model.guidance_type str]
                [--model.pag_applied_layers str]
                [--model.ladd_multi_scale str] [--model.head_block_ids str]
                [--model.extra str] [--vae.vae_type str]
                [--vae.vae_pretrained str] [--vae.weight_dtype str]
                [--vae.scale_factor str] [--vae.vae_latent_dim str]
                [--vae.vae_downsample_rate str] [--vae.sample_posterior str]
                [--vae.extra str] [--text_encoder.text_encoder_name str]
                [--text_encoder.caption_channels str]
                [--text_encoder.y_norm str]
                [--text_encoder.y_norm_scale_factor str]
                [--text_encoder.model_max_length str]
                [--text_encoder.chi_prompt str] [--text_encoder.extra str]
                [--scheduler.train_sampling_steps str]
                [--scheduler.predict_flow_v str]
                [--scheduler.noise_schedule str] [--scheduler.pred_sigma str]
                [--scheduler.learn_sigma str] [--scheduler.vis_sampler str]
                [--scheduler.flow_shift str]
                [--scheduler.weighting_scheme str]
                [--scheduler.weighting_scheme_discriminator str]
                [--scheduler.add_noise_timesteps str]
                [--scheduler.logit_mean str] [--scheduler.logit_std str]
                [--scheduler.logit_mean_discriminator str]
                [--scheduler.logit_std_discriminator str]
                [--scheduler.sigma_data str]
                [--scheduler.timestep_norm_scale_factor str]
                [--scheduler.extra str] [--train.num_workers str]
                [--train.seed str] [--train.train_batch_size str]
                [--train.num_epochs str]
                [--train.gradient_accumulation_steps str]
                [--train.grad_checkpointing str] [--train.gradient_clip str]
                [--train.gc_step str] [--train.optimizer str]
                [--train.optimizer_D str] [--train.load_from_optimizer str]
                [--train.load_from_lr_scheduler str]
                [--train.resume_lr_scheduler str] [--train.lr_schedule str]
                [--train.lr_schedule_args str] [--train.auto_lr str]
                [--train.eval_batch_size str] [--train.use_fsdp str]
                [--train.use_flash_attn str] [--train.eval_sampling_steps str]
                [--train.lora_rank str] [--train.log_interval str]
                [--train.mask_type str] [--train.mask_loss_coef str]
                [--train.load_mask_index str] [--train.snr_loss str]
                [--train.real_prompt_ratio str] [--train.early_stop_hours str]
                [--train.save_image_epochs str]
                [--train.save_model_epochs str] [--train.save_model_steps str]
                [--train.visualize str] [--train.null_embed_root str]
                [--train.valid_prompt_embed_root str]
                [--train.validation_prompts str] [--train.local_save_vis str]
                [--train.deterministic_validation str]
                [--train.online_metric str] [--train.eval_metric_step str]
                [--train.online_metric_dir str] [--train.work_dir str]
                [--train.skip_step str] [--train.loss_type str]
                [--train.huber_c str] [--train.num_ddim_timesteps str]
                [--train.ema_decay str] [--train.debug_nan str]
                [--train.ema_update str] [--train.ema_rate str]
                [--train.tangent_warmup_steps str] [--train.scm_cfg_scale str]
                [--train.cfg_interval str] [--train.scm_logvar_loss str]
                [--train.norm_invariant_to_spatial_dim str]
                [--train.norm_same_as_512_scale str]
                [--train.g_norm_constant str] [--train.g_norm_r str]
                [--train.show_gradient str] [--train.lr_scale str]
                [--train.adv_lambda str] [--train.scm_loss str]
                [--train.scm_lambda str] [--train.loss_scale str]
                [--train.r1_penalty str] [--train.r1_penalty_weight str]
                [--train.diff_timesteps_D str]
                [--train.suffix_checkpoints str]
                [--train.misaligned_pairs_D str]
                [--train.discriminator_loss str]
                [--train.largest_timestep str]
                [--train.train_largest_timestep str]
                [--train.largest_timestep_prob str] [--train.extra str]
                [--controlnet.control_signal_type str]
                [--controlnet.validation_scribble_maps str]
                [--model_growth.pretrained_ckpt_path str]
                [--model_growth.init_strategy str]
                [--model_growth.init_params str]
                [--model_growth.source_num_layers str]
                [--model_growth.target_num_layers str]
usage: train.py [-h] [--config_path str] [--work_dir str] [--resume_from str]
                [--load_from str] [--debug str] [--caching str]
                [--report_to str] [--tracker_project_name str] [--name str]
                [--loss_report_name str] [--data.data_dir str]
                [--data.caption_proportion str]
                [--data.external_caption_suffixes str]
                [--data.external_clipscore_suffixes str]
                [--data.clip_thr_temperature str] [--data.clip_thr str]
                [--data.del_img_clip_thr str] [--data.sort_dataset str]
                [--data.load_text_feat str] [--data.load_vae_feat str]
                [--data.transform str] [--data.type str]
                [--data.image_size str] [--data.hq_only str]
                [--data.valid_num str] [--data.data str] [--data.extra str]
                [--model.model str] [--model.teacher str]
                [--model.image_size str] [--model.mixed_precision str]
                [--model.fp32_attention str] [--model.load_from str]
                [--model.discriminator_model str] [--model.teacher_model str]
                [--model.teacher_model_weight_dtype str]
                [--model.resume_from str] [--model.aspect_ratio_type str]
                [--model.multi_scale str] [--model.pe_interpolation str]
                [--model.micro_condition str] [--model.attn_type str]
                [--model.autocast_linear_attn str] [--model.ffn_type str]
                [--model.mlp_acts str] [--model.mlp_ratio str]
                [--model.use_pe str] [--model.pos_embed_type str]
                [--model.qk_norm str] [--model.class_dropout_prob str]
                [--model.linear_head_dim str] [--model.cross_norm str]
                [--model.cross_attn_type str] [--model.logvar str]
                [--model.cfg_scale str] [--model.cfg_embed str]
                [--model.cfg_embed_scale str] [--model.guidance_type str]
                [--model.pag_applied_layers str]
                [--model.ladd_multi_scale str] [--model.head_block_ids str]
                [--model.extra str] [--vae.vae_type str]
                [--vae.vae_pretrained str] [--vae.weight_dtype str]
                [--vae.scale_factor str] [--vae.vae_latent_dim str]
                [--vae.vae_downsample_rate str] [--vae.sample_posterior str]
                [--vae.extra str] [--text_encoder.text_encoder_name str]
                [--text_encoder.caption_channels str]
                [--text_encoder.y_norm str]
                [--text_encoder.y_norm_scale_factor str]
                [--text_encoder.model_max_length str]
                [--text_encoder.chi_prompt str] [--text_encoder.extra str]
                [--scheduler.train_sampling_steps str]
                [--scheduler.predict_flow_v str]
                [--scheduler.noise_schedule str] [--scheduler.pred_sigma str]
                [--scheduler.learn_sigma str] [--scheduler.vis_sampler str]
                [--scheduler.flow_shift str]
                [--scheduler.weighting_scheme str]
                [--scheduler.weighting_scheme_discriminator str]
                [--scheduler.add_noise_timesteps str]
                [--scheduler.logit_mean str] [--scheduler.logit_std str]
                [--scheduler.logit_mean_discriminator str]
                [--scheduler.logit_std_discriminator str]
                [--scheduler.sigma_data str]
                [--scheduler.timestep_norm_scale_factor str]
                [--scheduler.extra str] [--train.num_workers str]
                [--train.seed str] [--train.train_batch_size str]
                [--train.num_epochs str]
                [--train.gradient_accumulation_steps str]
                [--train.grad_checkpointing str] [--train.gradient_clip str]
                [--train.gc_step str] [--train.optimizer str]
                [--train.optimizer_D str] [--train.load_from_optimizer str]
                [--train.load_from_lr_scheduler str]
                [--train.resume_lr_scheduler str] [--train.lr_schedule str]
                [--train.lr_schedule_args str] [--train.auto_lr str]
                [--train.eval_batch_size str] [--train.use_fsdp str]
                [--train.use_flash_attn str] [--train.eval_sampling_steps str]
                [--train.lora_rank str] [--train.log_interval str]
                [--train.mask_type str] [--train.mask_loss_coef str]
                [--train.load_mask_index str] [--train.snr_loss str]
                [--train.real_prompt_ratio str] [--train.early_stop_hours str]
                [--train.save_image_epochs str]
                [--train.save_model_epochs str] [--train.save_model_steps str]
                [--train.visualize str] [--train.null_embed_root str]
                [--train.valid_prompt_embed_root str]
                [--train.validation_prompts str] [--train.local_save_vis str]
                [--train.deterministic_validation str]
                [--train.online_metric str] [--train.eval_metric_step str]
                [--train.online_metric_dir str] [--train.work_dir str]
                [--train.skip_step str] [--train.loss_type str]
                [--train.huber_c str] [--train.num_ddim_timesteps str]
                [--train.ema_decay str] [--train.debug_nan str]
                [--train.ema_update str] [--train.ema_rate str]
                [--train.tangent_warmup_steps str] [--train.scm_cfg_scale str]
                [--train.cfg_interval str] [--train.scm_logvar_loss str]
                [--train.norm_invariant_to_spatial_dim str]
                [--train.norm_same_as_512_scale str]
                [--train.g_norm_constant str] [--train.g_norm_r str]
                [--train.show_gradient str] [--train.lr_scale str]
                [--train.adv_lambda str] [--train.scm_loss str]
                [--train.scm_lambda str] [--train.loss_scale str]
                [--train.r1_penalty str] [--train.r1_penalty_weight str]
                [--train.diff_timesteps_D str]
                [--train.suffix_checkpoints str]
                [--train.misaligned_pairs_D str]
                [--train.discriminator_loss str]
                [--train.largest_timestep str]
                [--train.train_largest_timestep str]
                [--train.largest_timestep_prob str] [--train.extra str]
                [--controlnet.control_signal_type str]
                [--controlnet.validation_scribble_maps str]
                [--model_growth.pretrained_ckpt_path str]
                [--model_growth.init_strategy str]
                [--model_growth.init_params str]
                [--model_growth.source_num_layers str]
                [--model_growth.target_num_layers str]
usage: train.py [-h] [--config_path str] [--work_dir str] [--resume_from str]
                [--load_from str] [--debug str] [--caching str]
                [--report_to str] [--tracker_project_name str] [--name str]
                [--loss_report_name str] [--data.data_dir str]
                [--data.caption_proportion str]
                [--data.external_caption_suffixes str]
                [--data.external_clipscore_suffixes str]
                [--data.clip_thr_temperature str] [--data.clip_thr str]
                [--data.del_img_clip_thr str] [--data.sort_dataset str]
                [--data.load_text_feat str] [--data.load_vae_feat str]
                [--data.transform str] [--data.type str]
                [--data.image_size str] [--data.hq_only str]
                [--data.valid_num str] [--data.data str] [--data.extra str]
                [--model.model str] [--model.teacher str]
                [--model.image_size str] [--model.mixed_precision str]
                [--model.fp32_attention str] [--model.load_from str]
                [--model.discriminator_model str] [--model.teacher_model str]
                [--model.teacher_model_weight_dtype str]
                [--model.resume_from str] [--model.aspect_ratio_type str]
                [--model.multi_scale str] [--model.pe_interpolation str]
                [--model.micro_condition str] [--model.attn_type str]
                [--model.autocast_linear_attn str] [--model.ffn_type str]
                [--model.mlp_acts str] [--model.mlp_ratio str]
                [--model.use_pe str] [--model.pos_embed_type str]
                [--model.qk_norm str] [--model.class_dropout_prob str]
                [--model.linear_head_dim str] [--model.cross_norm str]
                [--model.cross_attn_type str] [--model.logvar str]
                [--model.cfg_scale str] [--model.cfg_embed str]
                [--model.cfg_embed_scale str] [--model.guidance_type str]
                [--model.pag_applied_layers str]
                [--model.ladd_multi_scale str] [--model.head_block_ids str]
                [--model.extra str] [--vae.vae_type str]
                [--vae.vae_pretrained str] [--vae.weight_dtype str]
                [--vae.scale_factor str] [--vae.vae_latent_dim str]
                [--vae.vae_downsample_rate str] [--vae.sample_posterior str]
                [--vae.extra str] [--text_encoder.text_encoder_name str]
                [--text_encoder.caption_channels str]
                [--text_encoder.y_norm str]
                [--text_encoder.y_norm_scale_factor str]
                [--text_encoder.model_max_length str]
                [--text_encoder.chi_prompt str] [--text_encoder.extra str]
                [--scheduler.train_sampling_steps str]
                [--scheduler.predict_flow_v str]
                [--scheduler.noise_schedule str] [--scheduler.pred_sigma str]
                [--scheduler.learn_sigma str] [--scheduler.vis_sampler str]
                [--scheduler.flow_shift str]
                [--scheduler.weighting_scheme str]
                [--scheduler.weighting_scheme_discriminator str]
                [--scheduler.add_noise_timesteps str]
                [--scheduler.logit_mean str] [--scheduler.logit_std str]
                [--scheduler.logit_mean_discriminator str]
                [--scheduler.logit_std_discriminator str]
                [--scheduler.sigma_data str]
                [--scheduler.timestep_norm_scale_factor str]
                [--scheduler.extra str] [--train.num_workers str]
                [--train.seed str] [--train.train_batch_size str]
                [--train.num_epochs str]
                [--train.gradient_accumulation_steps str]
                [--train.grad_checkpointing str] [--train.gradient_clip str]
                [--train.gc_step str] [--train.optimizer str]
                [--train.optimizer_D str] [--train.load_from_optimizer str]
                [--train.load_from_lr_scheduler str]
                [--train.resume_lr_scheduler str] [--train.lr_schedule str]
                [--train.lr_schedule_args str] [--train.auto_lr str]
                [--train.eval_batch_size str] [--train.use_fsdp str]
                [--train.use_flash_attn str] [--train.eval_sampling_steps str]
                [--train.lora_rank str] [--train.log_interval str]
                [--train.mask_type str] [--train.mask_loss_coef str]
                [--train.load_mask_index str] [--train.snr_loss str]
                [--train.real_prompt_ratio str] [--train.early_stop_hours str]
                [--train.save_image_epochs str]
                [--train.save_model_epochs str] [--train.save_model_steps str]
                [--train.visualize str] [--train.null_embed_root str]
                [--train.valid_prompt_embed_root str]
                [--train.validation_prompts str] [--train.local_save_vis str]
                [--train.deterministic_validation str]
                [--train.online_metric str] [--train.eval_metric_step str]
                [--train.online_metric_dir str] [--train.work_dir str]
                [--train.skip_step str] [--train.loss_type str]
                [--train.huber_c str] [--train.num_ddim_timesteps str]
                [--train.ema_decay str] [--train.debug_nan str]
                [--train.ema_update str] [--train.ema_rate str]
                [--train.tangent_warmup_steps str] [--train.scm_cfg_scale str]
                [--train.cfg_interval str] [--train.scm_logvar_loss str]
                [--train.norm_invariant_to_spatial_dim str]
                [--train.norm_same_as_512_scale str]
                [--train.g_norm_constant str] [--train.g_norm_r str]
                [--train.show_gradient str] [--train.lr_scale str]
                [--train.adv_lambda str] [--train.scm_loss str]
                [--train.scm_lambda str] [--train.loss_scale str]
                [--train.r1_penalty str] [--train.r1_penalty_weight str]
                [--train.diff_timesteps_D str]
                [--train.suffix_checkpoints str]
                [--train.misaligned_pairs_D str]
                [--train.discriminator_loss str]
                [--train.largest_timestep str]
                [--train.train_largest_timestep str]
                [--train.largest_timestep_prob str] [--train.extra str]
                [--controlnet.control_signal_type str]
                [--controlnet.validation_scribble_maps str]
                [--model_growth.pretrained_ckpt_path str]
                [--model_growth.init_strategy str]
                [--model_growth.init_params str]
                [--model_growth.source_num_layers str]
                [--model_growth.target_num_layers str]
train.py: error: unrecognized arguments: 
train.py: error: unrecognized arguments: 
train.py: error: unrecognized arguments: 
usage: train.py [-h] [--config_path str] [--work_dir str] [--resume_from str]
                [--load_from str] [--debug str] [--caching str]
                [--report_to str] [--tracker_project_name str] [--name str]
                [--loss_report_name str] [--data.data_dir str]
                [--data.caption_proportion str]
                [--data.external_caption_suffixes str]
                [--data.external_clipscore_suffixes str]
                [--data.clip_thr_temperature str] [--data.clip_thr str]
                [--data.del_img_clip_thr str] [--data.sort_dataset str]
                [--data.load_text_feat str] [--data.load_vae_feat str]
                [--data.transform str] [--data.type str]
                [--data.image_size str] [--data.hq_only str]
                [--data.valid_num str] [--data.data str] [--data.extra str]
                [--model.model str] [--model.teacher str]
                [--model.image_size str] [--model.mixed_precision str]
                [--model.fp32_attention str] [--model.load_from str]
                [--model.discriminator_model str] [--model.teacher_model str]
                [--model.teacher_model_weight_dtype str]
                [--model.resume_from str] [--model.aspect_ratio_type str]
                [--model.multi_scale str] [--model.pe_interpolation str]
                [--model.micro_condition str] [--model.attn_type str]
                [--model.autocast_linear_attn str] [--model.ffn_type str]
                [--model.mlp_acts str] [--model.mlp_ratio str]
                [--model.use_pe str] [--model.pos_embed_type str]
                [--model.qk_norm str] [--model.class_dropout_prob str]
                [--model.linear_head_dim str] [--model.cross_norm str]
                [--model.cross_attn_type str] [--model.logvar str]
                [--model.cfg_scale str] [--model.cfg_embed str]
                [--model.cfg_embed_scale str] [--model.guidance_type str]
                [--model.pag_applied_layers str]
                [--model.ladd_multi_scale str] [--model.head_block_ids str]
                [--model.extra str] [--vae.vae_type str]
                [--vae.vae_pretrained str] [--vae.weight_dtype str]
                [--vae.scale_factor str] [--vae.vae_latent_dim str]
                [--vae.vae_downsample_rate str] [--vae.sample_posterior str]
                [--vae.extra str] [--text_encoder.text_encoder_name str]
                [--text_encoder.caption_channels str]
                [--text_encoder.y_norm str]
                [--text_encoder.y_norm_scale_factor str]
                [--text_encoder.model_max_length str]
                [--text_encoder.chi_prompt str] [--text_encoder.extra str]
                [--scheduler.train_sampling_steps str]
                [--scheduler.predict_flow_v str]
                [--scheduler.noise_schedule str] [--scheduler.pred_sigma str]
                [--scheduler.learn_sigma str] [--scheduler.vis_sampler str]
                [--scheduler.flow_shift str]
                [--scheduler.weighting_scheme str]
                [--scheduler.weighting_scheme_discriminator str]
                [--scheduler.add_noise_timesteps str]
                [--scheduler.logit_mean str] [--scheduler.logit_std str]
                [--scheduler.logit_mean_discriminator str]
                [--scheduler.logit_std_discriminator str]
                [--scheduler.sigma_data str]
                [--scheduler.timestep_norm_scale_factor str]
                [--scheduler.extra str] [--train.num_workers str]
                [--train.seed str] [--train.train_batch_size str]
                [--train.num_epochs str]
                [--train.gradient_accumulation_steps str]
                [--train.grad_checkpointing str] [--train.gradient_clip str]
                [--train.gc_step str] [--train.optimizer str]
                [--train.optimizer_D str] [--train.load_from_optimizer str]
                [--train.load_from_lr_scheduler str]
                [--train.resume_lr_scheduler str] [--train.lr_schedule str]
                [--train.lr_schedule_args str] [--train.auto_lr str]
                [--train.eval_batch_size str] [--train.use_fsdp str]
                [--train.use_flash_attn str] [--train.eval_sampling_steps str]
                [--train.lora_rank str] [--train.log_interval str]
                [--train.mask_type str] [--train.mask_loss_coef str]
                [--train.load_mask_index str] [--train.snr_loss str]
                [--train.real_prompt_ratio str] [--train.early_stop_hours str]
                [--train.save_image_epochs str]
                [--train.save_model_epochs str] [--train.save_model_steps str]
                [--train.visualize str] [--train.null_embed_root str]
                [--train.valid_prompt_embed_root str]
                [--train.validation_prompts str] [--train.local_save_vis str]
                [--train.deterministic_validation str]
                [--train.online_metric str] [--train.eval_metric_step str]
                [--train.online_metric_dir str] [--train.work_dir str]
                [--train.skip_step str] [--train.loss_type str]
                [--train.huber_c str] [--train.num_ddim_timesteps str]
                [--train.ema_decay str] [--train.debug_nan str]
                [--train.ema_update str] [--train.ema_rate str]
                [--train.tangent_warmup_steps str] [--train.scm_cfg_scale str]
                [--train.cfg_interval str] [--train.scm_logvar_loss str]
                [--train.norm_invariant_to_spatial_dim str]
                [--train.norm_same_as_512_scale str]
                [--train.g_norm_constant str] [--train.g_norm_r str]
                [--train.show_gradient str] [--train.lr_scale str]
                [--train.adv_lambda str] [--train.scm_loss str]
                [--train.scm_lambda str] [--train.loss_scale str]
                [--train.r1_penalty str] [--train.r1_penalty_weight str]
                [--train.diff_timesteps_D str]
                [--train.suffix_checkpoints str]
                [--train.misaligned_pairs_D str]
                [--train.discriminator_loss str]
                [--train.largest_timestep str]
                [--train.train_largest_timestep str]
                [--train.largest_timestep_prob str] [--train.extra str]
                [--controlnet.control_signal_type str]
                [--controlnet.validation_scribble_maps str]
                [--model_growth.pretrained_ckpt_path str]
                [--model_growth.init_strategy str]
                [--model_growth.init_params str]
                [--model_growth.source_num_layers str]
                [--model_growth.target_num_layers str]
train.py: error: unrecognized arguments: 
usage: train.py [-h] [--config_path str] [--work_dir str] [--resume_from str]
                [--load_from str] [--debug str] [--caching str]
                [--report_to str] [--tracker_project_name str] [--name str]
                [--loss_report_name str] [--data.data_dir str]
                [--data.caption_proportion str]
                [--data.external_caption_suffixes str]
                [--data.external_clipscore_suffixes str]
                [--data.clip_thr_temperature str] [--data.clip_thr str]
                [--data.del_img_clip_thr str] [--data.sort_dataset str]
                [--data.load_text_feat str] [--data.load_vae_feat str]
                [--data.transform str] [--data.type str]
                [--data.image_size str] [--data.hq_only str]
                [--data.valid_num str] [--data.data str] [--data.extra str]
                [--model.model str] [--model.teacher str]
                [--model.image_size str] [--model.mixed_precision str]
                [--model.fp32_attention str] [--model.load_from str]
                [--model.discriminator_model str] [--model.teacher_model str]
                [--model.teacher_model_weight_dtype str]
                [--model.resume_from str] [--model.aspect_ratio_type str]
                [--model.multi_scale str] [--model.pe_interpolation str]
                [--model.micro_condition str] [--model.attn_type str]
                [--model.autocast_linear_attn str] [--model.ffn_type str]
                [--model.mlp_acts str] [--model.mlp_ratio str]
                [--model.use_pe str] [--model.pos_embed_type str]
                [--model.qk_norm str] [--model.class_dropout_prob str]
                [--model.linear_head_dim str] [--model.cross_norm str]
                [--model.cross_attn_type str] [--model.logvar str]
                [--model.cfg_scale str] [--model.cfg_embed str]
                [--model.cfg_embed_scale str] [--model.guidance_type str]
                [--model.pag_applied_layers str]
                [--model.ladd_multi_scale str] [--model.head_block_ids str]
                [--model.extra str] [--vae.vae_type str]
                [--vae.vae_pretrained str] [--vae.weight_dtype str]
                [--vae.scale_factor str] [--vae.vae_latent_dim str]
                [--vae.vae_downsample_rate str] [--vae.sample_posterior str]
                [--vae.extra str] [--text_encoder.text_encoder_name str]
                [--text_encoder.caption_channels str]
                [--text_encoder.y_norm str]
                [--text_encoder.y_norm_scale_factor str]
                [--text_encoder.model_max_length str]
                [--text_encoder.chi_prompt str] [--text_encoder.extra str]
                [--scheduler.train_sampling_steps str]
                [--scheduler.predict_flow_v str]
                [--scheduler.noise_schedule str] [--scheduler.pred_sigma str]
                [--scheduler.learn_sigma str] [--scheduler.vis_sampler str]
                [--scheduler.flow_shift str]
                [--scheduler.weighting_scheme str]
                [--scheduler.weighting_scheme_discriminator str]
                [--scheduler.add_noise_timesteps str]
                [--scheduler.logit_mean str] [--scheduler.logit_std str]
                [--scheduler.logit_mean_discriminator str]
                [--scheduler.logit_std_discriminator str]
                [--scheduler.sigma_data str]
                [--scheduler.timestep_norm_scale_factor str]
                [--scheduler.extra str] [--train.num_workers str]
                [--train.seed str] [--train.train_batch_size str]
                [--train.num_epochs str]
                [--train.gradient_accumulation_steps str]
                [--train.grad_checkpointing str] [--train.gradient_clip str]
                [--train.gc_step str] [--train.optimizer str]
                [--train.optimizer_D str] [--train.load_from_optimizer str]
                [--train.load_from_lr_scheduler str]
                [--train.resume_lr_scheduler str] [--train.lr_schedule str]
                [--train.lr_schedule_args str] [--train.auto_lr str]
                [--train.eval_batch_size str] [--train.use_fsdp str]
                [--train.use_flash_attn str] [--train.eval_sampling_steps str]
                [--train.lora_rank str] [--train.log_interval str]
                [--train.mask_type str] [--train.mask_loss_coef str]
                [--train.load_mask_index str] [--train.snr_loss str]
                [--train.real_prompt_ratio str] [--train.early_stop_hours str]
                [--train.save_image_epochs str]
                [--train.save_model_epochs str] [--train.save_model_steps str]
                [--train.visualize str] [--train.null_embed_root str]
                [--train.valid_prompt_embed_root str]
                [--train.validation_prompts str] [--train.local_save_vis str]
                [--train.deterministic_validation str]
                [--train.online_metric str] [--train.eval_metric_step str]
                [--train.online_metric_dir str] [--train.work_dir str]
                [--train.skip_step str] [--train.loss_type str]
                [--train.huber_c str] [--train.num_ddim_timesteps str]
                [--train.ema_decay str] [--train.debug_nan str]
                [--train.ema_update str] [--train.ema_rate str]
                [--train.tangent_warmup_steps str] [--train.scm_cfg_scale str]
                [--train.cfg_interval str] [--train.scm_logvar_loss str]
                [--train.norm_invariant_to_spatial_dim str]
                [--train.norm_same_as_512_scale str]
                [--train.g_norm_constant str] [--train.g_norm_r str]
                [--train.show_gradient str] [--train.lr_scale str]
                [--train.adv_lambda str] [--train.scm_loss str]
                [--train.scm_lambda str] [--train.loss_scale str]
                [--train.r1_penalty str] [--train.r1_penalty_weight str]
                [--train.diff_timesteps_D str]
                [--train.suffix_checkpoints str]
                [--train.misaligned_pairs_D str]
                [--train.discriminator_loss str]
                [--train.largest_timestep str]
                [--train.train_largest_timestep str]
                [--train.largest_timestep_prob str] [--train.extra str]
                [--controlnet.control_signal_type str]
                [--controlnet.validation_scribble_maps str]
                [--model_growth.pretrained_ckpt_path str]
                [--model_growth.init_strategy str]
                [--model_growth.init_params str]
                [--model_growth.source_num_layers str]
                [--model_growth.target_num_layers str]
train.py: error: unrecognized arguments: 
usage: train.py [-h] [--config_path str] [--work_dir str] [--resume_from str]
                [--load_from str] [--debug str] [--caching str]
                [--report_to str] [--tracker_project_name str] [--name str]
                [--loss_report_name str] [--data.data_dir str]
                [--data.caption_proportion str]
                [--data.external_caption_suffixes str]
                [--data.external_clipscore_suffixes str]
                [--data.clip_thr_temperature str] [--data.clip_thr str]
                [--data.del_img_clip_thr str] [--data.sort_dataset str]
                [--data.load_text_feat str] [--data.load_vae_feat str]
                [--data.transform str] [--data.type str]
                [--data.image_size str] [--data.hq_only str]
                [--data.valid_num str] [--data.data str] [--data.extra str]
                [--model.model str] [--model.teacher str]
                [--model.image_size str] [--model.mixed_precision str]
                [--model.fp32_attention str] [--model.load_from str]
                [--model.discriminator_model str] [--model.teacher_model str]
                [--model.teacher_model_weight_dtype str]
                [--model.resume_from str] [--model.aspect_ratio_type str]
                [--model.multi_scale str] [--model.pe_interpolation str]
                [--model.micro_condition str] [--model.attn_type str]
                [--model.autocast_linear_attn str] [--model.ffn_type str]
                [--model.mlp_acts str] [--model.mlp_ratio str]
                [--model.use_pe str] [--model.pos_embed_type str]
                [--model.qk_norm str] [--model.class_dropout_prob str]
                [--model.linear_head_dim str] [--model.cross_norm str]
                [--model.cross_attn_type str] [--model.logvar str]
                [--model.cfg_scale str] [--model.cfg_embed str]
                [--model.cfg_embed_scale str] [--model.guidance_type str]
                [--model.pag_applied_layers str]
                [--model.ladd_multi_scale str] [--model.head_block_ids str]
                [--model.extra str] [--vae.vae_type str]
                [--vae.vae_pretrained str] [--vae.weight_dtype str]
                [--vae.scale_factor str] [--vae.vae_latent_dim str]
                [--vae.vae_downsample_rate str] [--vae.sample_posterior str]
                [--vae.extra str] [--text_encoder.text_encoder_name str]
                [--text_encoder.caption_channels str]
                [--text_encoder.y_norm str]
                [--text_encoder.y_norm_scale_factor str]
                [--text_encoder.model_max_length str]
                [--text_encoder.chi_prompt str] [--text_encoder.extra str]
                [--scheduler.train_sampling_steps str]
                [--scheduler.predict_flow_v str]
                [--scheduler.noise_schedule str] [--scheduler.pred_sigma str]
                [--scheduler.learn_sigma str] [--scheduler.vis_sampler str]
                [--scheduler.flow_shift str]
                [--scheduler.weighting_scheme str]
                [--scheduler.weighting_scheme_discriminator str]
                [--scheduler.add_noise_timesteps str]
                [--scheduler.logit_mean str] [--scheduler.logit_std str]
                [--scheduler.logit_mean_discriminator str]
                [--scheduler.logit_std_discriminator str]
                [--scheduler.sigma_data str]
                [--scheduler.timestep_norm_scale_factor str]
                [--scheduler.extra str] [--train.num_workers str]
                [--train.seed str] [--train.train_batch_size str]
                [--train.num_epochs str]
                [--train.gradient_accumulation_steps str]
                [--train.grad_checkpointing str] [--train.gradient_clip str]
                [--train.gc_step str] [--train.optimizer str]
                [--train.optimizer_D str] [--train.load_from_optimizer str]
                [--train.load_from_lr_scheduler str]
                [--train.resume_lr_scheduler str] [--train.lr_schedule str]
                [--train.lr_schedule_args str] [--train.auto_lr str]
                [--train.eval_batch_size str] [--train.use_fsdp str]
                [--train.use_flash_attn str] [--train.eval_sampling_steps str]
                [--train.lora_rank str] [--train.log_interval str]
                [--train.mask_type str] [--train.mask_loss_coef str]
                [--train.load_mask_index str] [--train.snr_loss str]
                [--train.real_prompt_ratio str] [--train.early_stop_hours str]
                [--train.save_image_epochs str]
                [--train.save_model_epochs str] [--train.save_model_steps str]
                [--train.visualize str] [--train.null_embed_root str]
                [--train.valid_prompt_embed_root str]
                [--train.validation_prompts str] [--train.local_save_vis str]
                [--train.deterministic_validation str]
                [--train.online_metric str] [--train.eval_metric_step str]
                [--train.online_metric_dir str] [--train.work_dir str]
                [--train.skip_step str] [--train.loss_type str]
                [--train.huber_c str] [--train.num_ddim_timesteps str]
                [--train.ema_decay str] [--train.debug_nan str]
                [--train.ema_update str] [--train.ema_rate str]
                [--train.tangent_warmup_steps str] [--train.scm_cfg_scale str]
                [--train.cfg_interval str] [--train.scm_logvar_loss str]
                [--train.norm_invariant_to_spatial_dim str]
                [--train.norm_same_as_512_scale str]
                [--train.g_norm_constant str] [--train.g_norm_r str]
                [--train.show_gradient str] [--train.lr_scale str]
                [--train.adv_lambda str] [--train.scm_loss str]
                [--train.scm_lambda str] [--train.loss_scale str]
                [--train.r1_penalty str] [--train.r1_penalty_weight str]
                [--train.diff_timesteps_D str]
                [--train.suffix_checkpoints str]
                [--train.misaligned_pairs_D str]
                [--train.discriminator_loss str]
                [--train.largest_timestep str]
                [--train.train_largest_timestep str]
                [--train.largest_timestep_prob str] [--train.extra str]
                [--controlnet.control_signal_type str]
                [--controlnet.validation_scribble_maps str]
                [--model_growth.pretrained_ckpt_path str]
                [--model_growth.init_strategy str]
                [--model_growth.init_params str]
                [--model_growth.source_num_layers str]
                [--model_growth.target_num_layers str]
train.py: error: unrecognized arguments: 
usage: train.py [-h] [--config_path str] [--work_dir str] [--resume_from str]
                [--load_from str] [--debug str] [--caching str]
                [--report_to str] [--tracker_project_name str] [--name str]
                [--loss_report_name str] [--data.data_dir str]
                [--data.caption_proportion str]
                [--data.external_caption_suffixes str]
                [--data.external_clipscore_suffixes str]
                [--data.clip_thr_temperature str] [--data.clip_thr str]
                [--data.del_img_clip_thr str] [--data.sort_dataset str]
                [--data.load_text_feat str] [--data.load_vae_feat str]
                [--data.transform str] [--data.type str]
                [--data.image_size str] [--data.hq_only str]
                [--data.valid_num str] [--data.data str] [--data.extra str]
                [--model.model str] [--model.teacher str]
                [--model.image_size str] [--model.mixed_precision str]
                [--model.fp32_attention str] [--model.load_from str]
                [--model.discriminator_model str] [--model.teacher_model str]
                [--model.teacher_model_weight_dtype str]
                [--model.resume_from str] [--model.aspect_ratio_type str]
                [--model.multi_scale str] [--model.pe_interpolation str]
                [--model.micro_condition str] [--model.attn_type str]
                [--model.autocast_linear_attn str] [--model.ffn_type str]
                [--model.mlp_acts str] [--model.mlp_ratio str]
                [--model.use_pe str] [--model.pos_embed_type str]
                [--model.qk_norm str] [--model.class_dropout_prob str]
                [--model.linear_head_dim str] [--model.cross_norm str]
                [--model.cross_attn_type str] [--model.logvar str]
                [--model.cfg_scale str] [--model.cfg_embed str]
                [--model.cfg_embed_scale str] [--model.guidance_type str]
                [--model.pag_applied_layers str]
                [--model.ladd_multi_scale str] [--model.head_block_ids str]
                [--model.extra str] [--vae.vae_type str]
                [--vae.vae_pretrained str] [--vae.weight_dtype str]
                [--vae.scale_factor str] [--vae.vae_latent_dim str]
                [--vae.vae_downsample_rate str] [--vae.sample_posterior str]
                [--vae.extra str] [--text_encoder.text_encoder_name str]
                [--text_encoder.caption_channels str]
                [--text_encoder.y_norm str]
                [--text_encoder.y_norm_scale_factor str]
                [--text_encoder.model_max_length str]
                [--text_encoder.chi_prompt str] [--text_encoder.extra str]
                [--scheduler.train_sampling_steps str]
                [--scheduler.predict_flow_v str]
                [--scheduler.noise_schedule str] [--scheduler.pred_sigma str]
                [--scheduler.learn_sigma str] [--scheduler.vis_sampler str]
                [--scheduler.flow_shift str]
                [--scheduler.weighting_scheme str]
                [--scheduler.weighting_scheme_discriminator str]
                [--scheduler.add_noise_timesteps str]
                [--scheduler.logit_mean str] [--scheduler.logit_std str]
                [--scheduler.logit_mean_discriminator str]
                [--scheduler.logit_std_discriminator str]
                [--scheduler.sigma_data str]
                [--scheduler.timestep_norm_scale_factor str]
                [--scheduler.extra str] [--train.num_workers str]
                [--train.seed str] [--train.train_batch_size str]
                [--train.num_epochs str]
                [--train.gradient_accumulation_steps str]
                [--train.grad_checkpointing str] [--train.gradient_clip str]
                [--train.gc_step str] [--train.optimizer str]
                [--train.optimizer_D str] [--train.load_from_optimizer str]
                [--train.load_from_lr_scheduler str]
                [--train.resume_lr_scheduler str] [--train.lr_schedule str]
                [--train.lr_schedule_args str] [--train.auto_lr str]
                [--train.eval_batch_size str] [--train.use_fsdp str]
                [--train.use_flash_attn str] [--train.eval_sampling_steps str]
                [--train.lora_rank str] [--train.log_interval str]
                [--train.mask_type str] [--train.mask_loss_coef str]
                [--train.load_mask_index str] [--train.snr_loss str]
                [--train.real_prompt_ratio str] [--train.early_stop_hours str]
                [--train.save_image_epochs str]
                [--train.save_model_epochs str] [--train.save_model_steps str]
                [--train.visualize str] [--train.null_embed_root str]
                [--train.valid_prompt_embed_root str]
                [--train.validation_prompts str] [--train.local_save_vis str]
                [--train.deterministic_validation str]
                [--train.online_metric str] [--train.eval_metric_step str]
                [--train.online_metric_dir str] [--train.work_dir str]
                [--train.skip_step str] [--train.loss_type str]
                [--train.huber_c str] [--train.num_ddim_timesteps str]
                [--train.ema_decay str] [--train.debug_nan str]
                [--train.ema_update str] [--train.ema_rate str]
                [--train.tangent_warmup_steps str] [--train.scm_cfg_scale str]
                [--train.cfg_interval str] [--train.scm_logvar_loss str]
                [--train.norm_invariant_to_spatial_dim str]
                [--train.norm_same_as_512_scale str]
                [--train.g_norm_constant str] [--train.g_norm_r str]
                [--train.show_gradient str] [--train.lr_scale str]
                [--train.adv_lambda str] [--train.scm_loss str]
                [--train.scm_lambda str] [--train.loss_scale str]
                [--train.r1_penalty str] [--train.r1_penalty_weight str]
                [--train.diff_timesteps_D str]
                [--train.suffix_checkpoints str]
                [--train.misaligned_pairs_D str]
                [--train.discriminator_loss str]
                [--train.largest_timestep str]
                [--train.train_largest_timestep str]
                [--train.largest_timestep_prob str] [--train.extra str]
                [--controlnet.control_signal_type str]
                [--controlnet.validation_scribble_maps str]
                [--model_growth.pretrained_ckpt_path str]
                [--model_growth.init_strategy str]
                [--model_growth.init_params str]
                [--model_growth.source_num_layers str]
                [--model_growth.target_num_layers str]
train.py: error: unrecognized arguments: 
usage: train.py [-h] [--config_path str] [--work_dir str] [--resume_from str]
                [--load_from str] [--debug str] [--caching str]
                [--report_to str] [--tracker_project_name str] [--name str]
                [--loss_report_name str] [--data.data_dir str]
                [--data.caption_proportion str]
                [--data.external_caption_suffixes str]
                [--data.external_clipscore_suffixes str]
                [--data.clip_thr_temperature str] [--data.clip_thr str]
                [--data.del_img_clip_thr str] [--data.sort_dataset str]
                [--data.load_text_feat str] [--data.load_vae_feat str]
                [--data.transform str] [--data.type str]
                [--data.image_size str] [--data.hq_only str]
                [--data.valid_num str] [--data.data str] [--data.extra str]
                [--model.model str] [--model.teacher str]
                [--model.image_size str] [--model.mixed_precision str]
                [--model.fp32_attention str] [--model.load_from str]
                [--model.discriminator_model str] [--model.teacher_model str]
                [--model.teacher_model_weight_dtype str]
                [--model.resume_from str] [--model.aspect_ratio_type str]
                [--model.multi_scale str] [--model.pe_interpolation str]
                [--model.micro_condition str] [--model.attn_type str]
                [--model.autocast_linear_attn str] [--model.ffn_type str]
                [--model.mlp_acts str] [--model.mlp_ratio str]
                [--model.use_pe str] [--model.pos_embed_type str]
                [--model.qk_norm str] [--model.class_dropout_prob str]
                [--model.linear_head_dim str] [--model.cross_norm str]
                [--model.cross_attn_type str] [--model.logvar str]
                [--model.cfg_scale str] [--model.cfg_embed str]
                [--model.cfg_embed_scale str] [--model.guidance_type str]
                [--model.pag_applied_layers str]
                [--model.ladd_multi_scale str] [--model.head_block_ids str]
                [--model.extra str] [--vae.vae_type str]
                [--vae.vae_pretrained str] [--vae.weight_dtype str]
                [--vae.scale_factor str] [--vae.vae_latent_dim str]
                [--vae.vae_downsample_rate str] [--vae.sample_posterior str]
                [--vae.extra str] [--text_encoder.text_encoder_name str]
                [--text_encoder.caption_channels str]
                [--text_encoder.y_norm str]
                [--text_encoder.y_norm_scale_factor str]
                [--text_encoder.model_max_length str]
                [--text_encoder.chi_prompt str] [--text_encoder.extra str]
                [--scheduler.train_sampling_steps str]
                [--scheduler.predict_flow_v str]
                [--scheduler.noise_schedule str] [--scheduler.pred_sigma str]
                [--scheduler.learn_sigma str] [--scheduler.vis_sampler str]
                [--scheduler.flow_shift str]
                [--scheduler.weighting_scheme str]
                [--scheduler.weighting_scheme_discriminator str]
                [--scheduler.add_noise_timesteps str]
                [--scheduler.logit_mean str] [--scheduler.logit_std str]
                [--scheduler.logit_mean_discriminator str]
                [--scheduler.logit_std_discriminator str]
                [--scheduler.sigma_data str]
                [--scheduler.timestep_norm_scale_factor str]
                [--scheduler.extra str] [--train.num_workers str]
                [--train.seed str] [--train.train_batch_size str]
                [--train.num_epochs str]
                [--train.gradient_accumulation_steps str]
                [--train.grad_checkpointing str] [--train.gradient_clip str]
                [--train.gc_step str] [--train.optimizer str]
                [--train.optimizer_D str] [--train.load_from_optimizer str]
                [--train.load_from_lr_scheduler str]
                [--train.resume_lr_scheduler str] [--train.lr_schedule str]
                [--train.lr_schedule_args str] [--train.auto_lr str]
                [--train.eval_batch_size str] [--train.use_fsdp str]
                [--train.use_flash_attn str] [--train.eval_sampling_steps str]
                [--train.lora_rank str] [--train.log_interval str]
                [--train.mask_type str] [--train.mask_loss_coef str]
                [--train.load_mask_index str] [--train.snr_loss str]
                [--train.real_prompt_ratio str] [--train.early_stop_hours str]
                [--train.save_image_epochs str]
                [--train.save_model_epochs str] [--train.save_model_steps str]
                [--train.visualize str] [--train.null_embed_root str]
                [--train.valid_prompt_embed_root str]
                [--train.validation_prompts str] [--train.local_save_vis str]
                [--train.deterministic_validation str]
                [--train.online_metric str] [--train.eval_metric_step str]
                [--train.online_metric_dir str] [--train.work_dir str]
                [--train.skip_step str] [--train.loss_type str]
                [--train.huber_c str] [--train.num_ddim_timesteps str]
                [--train.ema_decay str] [--train.debug_nan str]
                [--train.ema_update str] [--train.ema_rate str]
                [--train.tangent_warmup_steps str] [--train.scm_cfg_scale str]
                [--train.cfg_interval str] [--train.scm_logvar_loss str]
                [--train.norm_invariant_to_spatial_dim str]
                [--train.norm_same_as_512_scale str]
                [--train.g_norm_constant str] [--train.g_norm_r str]
                [--train.show_gradient str] [--train.lr_scale str]
                [--train.adv_lambda str] [--train.scm_loss str]
                [--train.scm_lambda str] [--train.loss_scale str]
                [--train.r1_penalty str] [--train.r1_penalty_weight str]
                [--train.diff_timesteps_D str]
                [--train.suffix_checkpoints str]
                [--train.misaligned_pairs_D str]
                [--train.discriminator_loss str]
                [--train.largest_timestep str]
                [--train.train_largest_timestep str]
                [--train.largest_timestep_prob str] [--train.extra str]
                [--controlnet.control_signal_type str]
                [--controlnet.validation_scribble_maps str]
                [--model_growth.pretrained_ckpt_path str]
                [--model_growth.init_strategy str]
                [--model_growth.init_params str]
                [--model_growth.source_num_layers str]
                [--model_growth.target_num_layers str]
train.py: error: unrecognized arguments: 
usage: train.py [-h] [--config_path str] [--work_dir str] [--resume_from str]
                [--load_from str] [--debug str] [--caching str]
                [--report_to str] [--tracker_project_name str] [--name str]
                [--loss_report_name str] [--data.data_dir str]
                [--data.caption_proportion str]
                [--data.external_caption_suffixes str]
                [--data.external_clipscore_suffixes str]
                [--data.clip_thr_temperature str] [--data.clip_thr str]
                [--data.del_img_clip_thr str] [--data.sort_dataset str]
                [--data.load_text_feat str] [--data.load_vae_feat str]
                [--data.transform str] [--data.type str]
                [--data.image_size str] [--data.hq_only str]
                [--data.valid_num str] [--data.data str] [--data.extra str]
                [--model.model str] [--model.teacher str]
                [--model.image_size str] [--model.mixed_precision str]
                [--model.fp32_attention str] [--model.load_from str]
                [--model.discriminator_model str] [--model.teacher_model str]
                [--model.teacher_model_weight_dtype str]
                [--model.resume_from str] [--model.aspect_ratio_type str]
                [--model.multi_scale str] [--model.pe_interpolation str]
                [--model.micro_condition str] [--model.attn_type str]
                [--model.autocast_linear_attn str] [--model.ffn_type str]
                [--model.mlp_acts str] [--model.mlp_ratio str]
                [--model.use_pe str] [--model.pos_embed_type str]
                [--model.qk_norm str] [--model.class_dropout_prob str]
                [--model.linear_head_dim str] [--model.cross_norm str]
                [--model.cross_attn_type str] [--model.logvar str]
                [--model.cfg_scale str] [--model.cfg_embed str]
                [--model.cfg_embed_scale str] [--model.guidance_type str]
                [--model.pag_applied_layers str]
                [--model.ladd_multi_scale str] [--model.head_block_ids str]
                [--model.extra str] [--vae.vae_type str]
                [--vae.vae_pretrained str] [--vae.weight_dtype str]
                [--vae.scale_factor str] [--vae.vae_latent_dim str]
                [--vae.vae_downsample_rate str] [--vae.sample_posterior str]
                [--vae.extra str] [--text_encoder.text_encoder_name str]
                [--text_encoder.caption_channels str]
                [--text_encoder.y_norm str]
                [--text_encoder.y_norm_scale_factor str]
                [--text_encoder.model_max_length str]
                [--text_encoder.chi_prompt str] [--text_encoder.extra str]
                [--scheduler.train_sampling_steps str]
                [--scheduler.predict_flow_v str]
                [--scheduler.noise_schedule str] [--scheduler.pred_sigma str]
                [--scheduler.learn_sigma str] [--scheduler.vis_sampler str]
                [--scheduler.flow_shift str]
                [--scheduler.weighting_scheme str]
                [--scheduler.weighting_scheme_discriminator str]
                [--scheduler.add_noise_timesteps str]
                [--scheduler.logit_mean str] [--scheduler.logit_std str]
                [--scheduler.logit_mean_discriminator str]
                [--scheduler.logit_std_discriminator str]
                [--scheduler.sigma_data str]
                [--scheduler.timestep_norm_scale_factor str]
                [--scheduler.extra str] [--train.num_workers str]
                [--train.seed str] [--train.train_batch_size str]
                [--train.num_epochs str]
                [--train.gradient_accumulation_steps str]
                [--train.grad_checkpointing str] [--train.gradient_clip str]
                [--train.gc_step str] [--train.optimizer str]
                [--train.optimizer_D str] [--train.load_from_optimizer str]
                [--train.load_from_lr_scheduler str]
                [--train.resume_lr_scheduler str] [--train.lr_schedule str]
                [--train.lr_schedule_args str] [--train.auto_lr str]
                [--train.eval_batch_size str] [--train.use_fsdp str]
                [--train.use_flash_attn str] [--train.eval_sampling_steps str]
                [--train.lora_rank str] [--train.log_interval str]
                [--train.mask_type str] [--train.mask_loss_coef str]
                [--train.load_mask_index str] [--train.snr_loss str]
                [--train.real_prompt_ratio str] [--train.early_stop_hours str]
                [--train.save_image_epochs str]
                [--train.save_model_epochs str] [--train.save_model_steps str]
                [--train.visualize str] [--train.null_embed_root str]
                [--train.valid_prompt_embed_root str]
                [--train.validation_prompts str] [--train.local_save_vis str]
                [--train.deterministic_validation str]
                [--train.online_metric str] [--train.eval_metric_step str]
                [--train.online_metric_dir str] [--train.work_dir str]
                [--train.skip_step str] [--train.loss_type str]
                [--train.huber_c str] [--train.num_ddim_timesteps str]
                [--train.ema_decay str] [--train.debug_nan str]
                [--train.ema_update str] [--train.ema_rate str]
                [--train.tangent_warmup_steps str] [--train.scm_cfg_scale str]
                [--train.cfg_interval str] [--train.scm_logvar_loss str]
                [--train.norm_invariant_to_spatial_dim str]
                [--train.norm_same_as_512_scale str]
                [--train.g_norm_constant str] [--train.g_norm_r str]
                [--train.show_gradient str] [--train.lr_scale str]
                [--train.adv_lambda str] [--train.scm_loss str]
                [--train.scm_lambda str] [--train.loss_scale str]
                [--train.r1_penalty str] [--train.r1_penalty_weight str]
                [--train.diff_timesteps_D str]
                [--train.suffix_checkpoints str]
                [--train.misaligned_pairs_D str]
                [--train.discriminator_loss str]
                [--train.largest_timestep str]
                [--train.train_largest_timestep str]
                [--train.largest_timestep_prob str] [--train.extra str]
                [--controlnet.control_signal_type str]
                [--controlnet.validation_scribble_maps str]
                [--model_growth.pretrained_ckpt_path str]
                [--model_growth.init_strategy str]
                [--model_growth.init_params str]
                [--model_growth.source_num_layers str]
                [--model_growth.target_num_layers str]
usage: train.py [-h] [--config_path str] [--work_dir str] [--resume_from str]
                [--load_from str] [--debug str] [--caching str]
                [--report_to str] [--tracker_project_name str] [--name str]
                [--loss_report_name str] [--data.data_dir str]
                [--data.caption_proportion str]
                [--data.external_caption_suffixes str]
                [--data.external_clipscore_suffixes str]
                [--data.clip_thr_temperature str] [--data.clip_thr str]
                [--data.del_img_clip_thr str] [--data.sort_dataset str]
                [--data.load_text_feat str] [--data.load_vae_feat str]
                [--data.transform str] [--data.type str]
                [--data.image_size str] [--data.hq_only str]
                [--data.valid_num str] [--data.data str] [--data.extra str]
                [--model.model str] [--model.teacher str]
                [--model.image_size str] [--model.mixed_precision str]
                [--model.fp32_attention str] [--model.load_from str]
                [--model.discriminator_model str] [--model.teacher_model str]
                [--model.teacher_model_weight_dtype str]
                [--model.resume_from str] [--model.aspect_ratio_type str]
                [--model.multi_scale str] [--model.pe_interpolation str]
                [--model.micro_condition str] [--model.attn_type str]
                [--model.autocast_linear_attn str] [--model.ffn_type str]
                [--model.mlp_acts str] [--model.mlp_ratio str]
                [--model.use_pe str] [--model.pos_embed_type str]
                [--model.qk_norm str] [--model.class_dropout_prob str]
                [--model.linear_head_dim str] [--model.cross_norm str]
                [--model.cross_attn_type str] [--model.logvar str]
                [--model.cfg_scale str] [--model.cfg_embed str]
                [--model.cfg_embed_scale str] [--model.guidance_type str]
                [--model.pag_applied_layers str]
                [--model.ladd_multi_scale str] [--model.head_block_ids str]
                [--model.extra str] [--vae.vae_type str]
                [--vae.vae_pretrained str] [--vae.weight_dtype str]
                [--vae.scale_factor str] [--vae.vae_latent_dim str]
                [--vae.vae_downsample_rate str] [--vae.sample_posterior str]
                [--vae.extra str] [--text_encoder.text_encoder_name str]
                [--text_encoder.caption_channels str]
                [--text_encoder.y_norm str]
                [--text_encoder.y_norm_scale_factor str]
                [--text_encoder.model_max_length str]
                [--text_encoder.chi_prompt str] [--text_encoder.extra str]
                [--scheduler.train_sampling_steps str]
                [--scheduler.predict_flow_v str]
                [--scheduler.noise_schedule str] [--scheduler.pred_sigma str]
                [--scheduler.learn_sigma str] [--scheduler.vis_sampler str]
                [--scheduler.flow_shift str]
                [--scheduler.weighting_scheme str]
                [--scheduler.weighting_scheme_discriminator str]
                [--scheduler.add_noise_timesteps str]
                [--scheduler.logit_mean str] [--scheduler.logit_std str]
                [--scheduler.logit_mean_discriminator str]
                [--scheduler.logit_std_discriminator str]
                [--scheduler.sigma_data str]
                [--scheduler.timestep_norm_scale_factor str]
                [--scheduler.extra str] [--train.num_workers str]
                [--train.seed str] [--train.train_batch_size str]
                [--train.num_epochs str]
                [--train.gradient_accumulation_steps str]
                [--train.grad_checkpointing str] [--train.gradient_clip str]
                [--train.gc_step str] [--train.optimizer str]
                [--train.optimizer_D str] [--train.load_from_optimizer str]
                [--train.load_from_lr_scheduler str]
                [--train.resume_lr_scheduler str] [--train.lr_schedule str]
                [--train.lr_schedule_args str] [--train.auto_lr str]
                [--train.eval_batch_size str] [--train.use_fsdp str]
                [--train.use_flash_attn str] [--train.eval_sampling_steps str]
                [--train.lora_rank str] [--train.log_interval str]
                [--train.mask_type str] [--train.mask_loss_coef str]
                [--train.load_mask_index str] [--train.snr_loss str]
                [--train.real_prompt_ratio str] [--train.early_stop_hours str]
                [--train.save_image_epochs str]
                [--train.save_model_epochs str] [--train.save_model_steps str]
                [--train.visualize str] [--train.null_embed_root str]
                [--train.valid_prompt_embed_root str]
                [--train.validation_prompts str] [--train.local_save_vis str]
                [--train.deterministic_validation str]
                [--train.online_metric str] [--train.eval_metric_step str]
                [--train.online_metric_dir str] [--train.work_dir str]
                [--train.skip_step str] [--train.loss_type str]
                [--train.huber_c str] [--train.num_ddim_timesteps str]
                [--train.ema_decay str] [--train.debug_nan str]
                [--train.ema_update str] [--train.ema_rate str]
                [--train.tangent_warmup_steps str] [--train.scm_cfg_scale str]
                [--train.cfg_interval str] [--train.scm_logvar_loss str]
                [--train.norm_invariant_to_spatial_dim str]
                [--train.norm_same_as_512_scale str]
                [--train.g_norm_constant str] [--train.g_norm_r str]
                [--train.show_gradient str] [--train.lr_scale str]
                [--train.adv_lambda str] [--train.scm_loss str]
                [--train.scm_lambda str] [--train.loss_scale str]
                [--train.r1_penalty str] [--train.r1_penalty_weight str]
                [--train.diff_timesteps_D str]
                [--train.suffix_checkpoints str]
                [--train.misaligned_pairs_D str]
                [--train.discriminator_loss str]
                [--train.largest_timestep str]
                [--train.train_largest_timestep str]
                [--train.largest_timestep_prob str] [--train.extra str]
                [--controlnet.control_signal_type str]
                [--controlnet.validation_scribble_maps str]
                [--model_growth.pretrained_ckpt_path str]
                [--model_growth.init_strategy str]
                [--model_growth.init_params str]
                [--model_growth.source_num_layers str]
                [--model_growth.target_num_layers str]
train.py: error: unrecognized arguments: 
train.py: error: unrecognized arguments: 
usage: train.py [-h] [--config_path str] [--work_dir str] [--resume_from str]
                [--load_from str] [--debug str] [--caching str]
                [--report_to str] [--tracker_project_name str] [--name str]
                [--loss_report_name str] [--data.data_dir str]
                [--data.caption_proportion str]
                [--data.external_caption_suffixes str]
                [--data.external_clipscore_suffixes str]
                [--data.clip_thr_temperature str] [--data.clip_thr str]
                [--data.del_img_clip_thr str] [--data.sort_dataset str]
                [--data.load_text_feat str] [--data.load_vae_feat str]
                [--data.transform str] [--data.type str]
                [--data.image_size str] [--data.hq_only str]
                [--data.valid_num str] [--data.data str] [--data.extra str]
                [--model.model str] [--model.teacher str]
                [--model.image_size str] [--model.mixed_precision str]
                [--model.fp32_attention str] [--model.load_from str]
                [--model.discriminator_model str] [--model.teacher_model str]
                [--model.teacher_model_weight_dtype str]
                [--model.resume_from str] [--model.aspect_ratio_type str]
                [--model.multi_scale str] [--model.pe_interpolation str]
                [--model.micro_condition str] [--model.attn_type str]
                [--model.autocast_linear_attn str] [--model.ffn_type str]
                [--model.mlp_acts str] [--model.mlp_ratio str]
                [--model.use_pe str] [--model.pos_embed_type str]
                [--model.qk_norm str] [--model.class_dropout_prob str]
                [--model.linear_head_dim str] [--model.cross_norm str]
                [--model.cross_attn_type str] [--model.logvar str]
                [--model.cfg_scale str] [--model.cfg_embed str]
                [--model.cfg_embed_scale str] [--model.guidance_type str]
                [--model.pag_applied_layers str]
                [--model.ladd_multi_scale str] [--model.head_block_ids str]
                [--model.extra str] [--vae.vae_type str]
                [--vae.vae_pretrained str] [--vae.weight_dtype str]
                [--vae.scale_factor str] [--vae.vae_latent_dim str]
                [--vae.vae_downsample_rate str] [--vae.sample_posterior str]
                [--vae.extra str] [--text_encoder.text_encoder_name str]
                [--text_encoder.caption_channels str]
                [--text_encoder.y_norm str]
                [--text_encoder.y_norm_scale_factor str]
                [--text_encoder.model_max_length str]
                [--text_encoder.chi_prompt str] [--text_encoder.extra str]
                [--scheduler.train_sampling_steps str]
                [--scheduler.predict_flow_v str]
                [--scheduler.noise_schedule str] [--scheduler.pred_sigma str]
                [--scheduler.learn_sigma str] [--scheduler.vis_sampler str]
                [--scheduler.flow_shift str]
                [--scheduler.weighting_scheme str]
                [--scheduler.weighting_scheme_discriminator str]
                [--scheduler.add_noise_timesteps str]
                [--scheduler.logit_mean str] [--scheduler.logit_std str]
                [--scheduler.logit_mean_discriminator str]
                [--scheduler.logit_std_discriminator str]
                [--scheduler.sigma_data str]
                [--scheduler.timestep_norm_scale_factor str]
                [--scheduler.extra str] [--train.num_workers str]
                [--train.seed str] [--train.train_batch_size str]
                [--train.num_epochs str]
                [--train.gradient_accumulation_steps str]
                [--train.grad_checkpointing str] [--train.gradient_clip str]
                [--train.gc_step str] [--train.optimizer str]
                [--train.optimizer_D str] [--train.load_from_optimizer str]
                [--train.load_from_lr_scheduler str]
                [--train.resume_lr_scheduler str] [--train.lr_schedule str]
                [--train.lr_schedule_args str] [--train.auto_lr str]
                [--train.eval_batch_size str] [--train.use_fsdp str]
                [--train.use_flash_attn str] [--train.eval_sampling_steps str]
                [--train.lora_rank str] [--train.log_interval str]
                [--train.mask_type str] [--train.mask_loss_coef str]
                [--train.load_mask_index str] [--train.snr_loss str]
                [--train.real_prompt_ratio str] [--train.early_stop_hours str]
                [--train.save_image_epochs str]
                [--train.save_model_epochs str] [--train.save_model_steps str]
                [--train.visualize str] [--train.null_embed_root str]
                [--train.valid_prompt_embed_root str]
                [--train.validation_prompts str] [--train.local_save_vis str]
                [--train.deterministic_validation str]
                [--train.online_metric str] [--train.eval_metric_step str]
                [--train.online_metric_dir str] [--train.work_dir str]
                [--train.skip_step str] [--train.loss_type str]
                [--train.huber_c str] [--train.num_ddim_timesteps str]
                [--train.ema_decay str] [--train.debug_nan str]
                [--train.ema_update str] [--train.ema_rate str]
                [--train.tangent_warmup_steps str] [--train.scm_cfg_scale str]
                [--train.cfg_interval str] [--train.scm_logvar_loss str]
                [--train.norm_invariant_to_spatial_dim str]
                [--train.norm_same_as_512_scale str]
                [--train.g_norm_constant str] [--train.g_norm_r str]
                [--train.show_gradient str] [--train.lr_scale str]
                [--train.adv_lambda str] [--train.scm_loss str]
                [--train.scm_lambda str] [--train.loss_scale str]
                [--train.r1_penalty str] [--train.r1_penalty_weight str]
                [--train.diff_timesteps_D str]
                [--train.suffix_checkpoints str]
                [--train.misaligned_pairs_D str]
                [--train.discriminator_loss str]
                [--train.largest_timestep str]
                [--train.train_largest_timestep str]
                [--train.largest_timestep_prob str] [--train.extra str]
                [--controlnet.control_signal_type str]
                [--controlnet.validation_scribble_maps str]
                [--model_growth.pretrained_ckpt_path str]
                [--model_growth.init_strategy str]
                [--model_growth.init_params str]
                [--model_growth.source_num_layers str]
                [--model_growth.target_num_layers str]
train.py: error: unrecognized arguments: 
usage: train.py [-h] [--config_path str] [--work_dir str] [--resume_from str]
                [--load_from str] [--debug str] [--caching str]
                [--report_to str] [--tracker_project_name str] [--name str]
                [--loss_report_name str] [--data.data_dir str]
                [--data.caption_proportion str]
                [--data.external_caption_suffixes str]
                [--data.external_clipscore_suffixes str]
                [--data.clip_thr_temperature str] [--data.clip_thr str]
                [--data.del_img_clip_thr str] [--data.sort_dataset str]
                [--data.load_text_feat str] [--data.load_vae_feat str]
                [--data.transform str] [--data.type str]
                [--data.image_size str] [--data.hq_only str]
                [--data.valid_num str] [--data.data str] [--data.extra str]
                [--model.model str] [--model.teacher str]
                [--model.image_size str] [--model.mixed_precision str]
                [--model.fp32_attention str] [--model.load_from str]
                [--model.discriminator_model str] [--model.teacher_model str]
                [--model.teacher_model_weight_dtype str]
                [--model.resume_from str] [--model.aspect_ratio_type str]
                [--model.multi_scale str] [--model.pe_interpolation str]
                [--model.micro_condition str] [--model.attn_type str]
                [--model.autocast_linear_attn str] [--model.ffn_type str]
                [--model.mlp_acts str] [--model.mlp_ratio str]
                [--model.use_pe str] [--model.pos_embed_type str]
                [--model.qk_norm str] [--model.class_dropout_prob str]
                [--model.linear_head_dim str] [--model.cross_norm str]
                [--model.cross_attn_type str] [--model.logvar str]
                [--model.cfg_scale str] [--model.cfg_embed str]
                [--model.cfg_embed_scale str] [--model.guidance_type str]
                [--model.pag_applied_layers str]
                [--model.ladd_multi_scale str] [--model.head_block_ids str]
                [--model.extra str] [--vae.vae_type str]
                [--vae.vae_pretrained str] [--vae.weight_dtype str]
                [--vae.scale_factor str] [--vae.vae_latent_dim str]
                [--vae.vae_downsample_rate str] [--vae.sample_posterior str]
                [--vae.extra str] [--text_encoder.text_encoder_name str]
                [--text_encoder.caption_channels str]
                [--text_encoder.y_norm str]
                [--text_encoder.y_norm_scale_factor str]
                [--text_encoder.model_max_length str]
                [--text_encoder.chi_prompt str] [--text_encoder.extra str]
                [--scheduler.train_sampling_steps str]
                [--scheduler.predict_flow_v str]
                [--scheduler.noise_schedule str] [--scheduler.pred_sigma str]
                [--scheduler.learn_sigma str] [--scheduler.vis_sampler str]
                [--scheduler.flow_shift str]
                [--scheduler.weighting_scheme str]
                [--scheduler.weighting_scheme_discriminator str]
                [--scheduler.add_noise_timesteps str]
                [--scheduler.logit_mean str] [--scheduler.logit_std str]
                [--scheduler.logit_mean_discriminator str]
                [--scheduler.logit_std_discriminator str]
                [--scheduler.sigma_data str]
                [--scheduler.timestep_norm_scale_factor str]
                [--scheduler.extra str] [--train.num_workers str]
                [--train.seed str] [--train.train_batch_size str]
                [--train.num_epochs str]
                [--train.gradient_accumulation_steps str]
                [--train.grad_checkpointing str] [--train.gradient_clip str]
                [--train.gc_step str] [--train.optimizer str]
                [--train.optimizer_D str] [--train.load_from_optimizer str]
                [--train.load_from_lr_scheduler str]
                [--train.resume_lr_scheduler str] [--train.lr_schedule str]
                [--train.lr_schedule_args str] [--train.auto_lr str]
                [--train.eval_batch_size str] [--train.use_fsdp str]
                [--train.use_flash_attn str] [--train.eval_sampling_steps str]
                [--train.lora_rank str] [--train.log_interval str]
                [--train.mask_type str] [--train.mask_loss_coef str]
                [--train.load_mask_index str] [--train.snr_loss str]
                [--train.real_prompt_ratio str] [--train.early_stop_hours str]
                [--train.save_image_epochs str]
                [--train.save_model_epochs str] [--train.save_model_steps str]
                [--train.visualize str] [--train.null_embed_root str]
                [--train.valid_prompt_embed_root str]
                [--train.validation_prompts str] [--train.local_save_vis str]
                [--train.deterministic_validation str]
                [--train.online_metric str] [--train.eval_metric_step str]
                [--train.online_metric_dir str] [--train.work_dir str]
                [--train.skip_step str] [--train.loss_type str]
                [--train.huber_c str] [--train.num_ddim_timesteps str]
                [--train.ema_decay str] [--train.debug_nan str]
                [--train.ema_update str] [--train.ema_rate str]
                [--train.tangent_warmup_steps str] [--train.scm_cfg_scale str]
                [--train.cfg_interval str] [--train.scm_logvar_loss str]
                [--train.norm_invariant_to_spatial_dim str]
                [--train.norm_same_as_512_scale str]
                [--train.g_norm_constant str] [--train.g_norm_r str]
                [--train.show_gradient str] [--train.lr_scale str]
                [--train.adv_lambda str] [--train.scm_loss str]
                [--train.scm_lambda str] [--train.loss_scale str]
                [--train.r1_penalty str] [--train.r1_penalty_weight str]
                [--train.diff_timesteps_D str]
                [--train.suffix_checkpoints str]
                [--train.misaligned_pairs_D str]
                [--train.discriminator_loss str]
                [--train.largest_timestep str]
                [--train.train_largest_timestep str]
                [--train.largest_timestep_prob str] [--train.extra str]
                [--controlnet.control_signal_type str]
                [--controlnet.validation_scribble_maps str]
                [--model_growth.pretrained_ckpt_path str]
                [--model_growth.init_strategy str]
                [--model_growth.init_params str]
                [--model_growth.source_num_layers str]
                [--model_growth.target_num_layers str]
train.py: error: unrecognized arguments: 
usage: train.py [-h] [--config_path str] [--work_dir str] [--resume_from str]
                [--load_from str] [--debug str] [--caching str]
                [--report_to str] [--tracker_project_name str] [--name str]
                [--loss_report_name str] [--data.data_dir str]
                [--data.caption_proportion str]
                [--data.external_caption_suffixes str]
                [--data.external_clipscore_suffixes str]
                [--data.clip_thr_temperature str] [--data.clip_thr str]
                [--data.del_img_clip_thr str] [--data.sort_dataset str]
                [--data.load_text_feat str] [--data.load_vae_feat str]
                [--data.transform str] [--data.type str]
                [--data.image_size str] [--data.hq_only str]
                [--data.valid_num str] [--data.data str] [--data.extra str]
                [--model.model str] [--model.teacher str]
                [--model.image_size str] [--model.mixed_precision str]
                [--model.fp32_attention str] [--model.load_from str]
                [--model.discriminator_model str] [--model.teacher_model str]
                [--model.teacher_model_weight_dtype str]
                [--model.resume_from str] [--model.aspect_ratio_type str]
                [--model.multi_scale str] [--model.pe_interpolation str]
                [--model.micro_condition str] [--model.attn_type str]
                [--model.autocast_linear_attn str] [--model.ffn_type str]
                [--model.mlp_acts str] [--model.mlp_ratio str]
                [--model.use_pe str] [--model.pos_embed_type str]
                [--model.qk_norm str] [--model.class_dropout_prob str]
                [--model.linear_head_dim str] [--model.cross_norm str]
                [--model.cross_attn_type str] [--model.logvar str]
                [--model.cfg_scale str] [--model.cfg_embed str]
                [--model.cfg_embed_scale str] [--model.guidance_type str]
                [--model.pag_applied_layers str]
                [--model.ladd_multi_scale str] [--model.head_block_ids str]
                [--model.extra str] [--vae.vae_type str]
                [--vae.vae_pretrained str] [--vae.weight_dtype str]
                [--vae.scale_factor str] [--vae.vae_latent_dim str]
                [--vae.vae_downsample_rate str] [--vae.sample_posterior str]
                [--vae.extra str] [--text_encoder.text_encoder_name str]
                [--text_encoder.caption_channels str]
                [--text_encoder.y_norm str]
                [--text_encoder.y_norm_scale_factor str]
                [--text_encoder.model_max_length str]
                [--text_encoder.chi_prompt str] [--text_encoder.extra str]
                [--scheduler.train_sampling_steps str]
                [--scheduler.predict_flow_v str]
                [--scheduler.noise_schedule str] [--scheduler.pred_sigma str]
                [--scheduler.learn_sigma str] [--scheduler.vis_sampler str]
                [--scheduler.flow_shift str]
                [--scheduler.weighting_scheme str]
                [--scheduler.weighting_scheme_discriminator str]
                [--scheduler.add_noise_timesteps str]
                [--scheduler.logit_mean str] [--scheduler.logit_std str]
                [--scheduler.logit_mean_discriminator str]
                [--scheduler.logit_std_discriminator str]
                [--scheduler.sigma_data str]
                [--scheduler.timestep_norm_scale_factor str]
                [--scheduler.extra str] [--train.num_workers str]
                [--train.seed str] [--train.train_batch_size str]
                [--train.num_epochs str]
                [--train.gradient_accumulation_steps str]
                [--train.grad_checkpointing str] [--train.gradient_clip str]
                [--train.gc_step str] [--train.optimizer str]
                [--train.optimizer_D str] [--train.load_from_optimizer str]
                [--train.load_from_lr_scheduler str]
                [--train.resume_lr_scheduler str] [--train.lr_schedule str]
                [--train.lr_schedule_args str] [--train.auto_lr str]
                [--train.eval_batch_size str] [--train.use_fsdp str]
                [--train.use_flash_attn str] [--train.eval_sampling_steps str]
                [--train.lora_rank str] [--train.log_interval str]
                [--train.mask_type str] [--train.mask_loss_coef str]
                [--train.load_mask_index str] [--train.snr_loss str]
                [--train.real_prompt_ratio str] [--train.early_stop_hours str]
                [--train.save_image_epochs str]
                [--train.save_model_epochs str] [--train.save_model_steps str]
                [--train.visualize str] [--train.null_embed_root str]
                [--train.valid_prompt_embed_root str]
                [--train.validation_prompts str] [--train.local_save_vis str]
                [--train.deterministic_validation str]
                [--train.online_metric str] [--train.eval_metric_step str]
                [--train.online_metric_dir str] [--train.work_dir str]
                [--train.skip_step str] [--train.loss_type str]
                [--train.huber_c str] [--train.num_ddim_timesteps str]
                [--train.ema_decay str] [--train.debug_nan str]
                [--train.ema_update str] [--train.ema_rate str]
                [--train.tangent_warmup_steps str] [--train.scm_cfg_scale str]
                [--train.cfg_interval str] [--train.scm_logvar_loss str]
                [--train.norm_invariant_to_spatial_dim str]
                [--train.norm_same_as_512_scale str]
                [--train.g_norm_constant str] [--train.g_norm_r str]
                [--train.show_gradient str] [--train.lr_scale str]
                [--train.adv_lambda str] [--train.scm_loss str]
                [--train.scm_lambda str] [--train.loss_scale str]
                [--train.r1_penalty str] [--train.r1_penalty_weight str]
                [--train.diff_timesteps_D str]
                [--train.suffix_checkpoints str]
                [--train.misaligned_pairs_D str]
                [--train.discriminator_loss str]
                [--train.largest_timestep str]
                [--train.train_largest_timestep str]
                [--train.largest_timestep_prob str] [--train.extra str]
                [--controlnet.control_signal_type str]
                [--controlnet.validation_scribble_maps str]
                [--model_growth.pretrained_ckpt_path str]
                [--model_growth.init_strategy str]
                [--model_growth.init_params str]
                [--model_growth.source_num_layers str]
                [--model_growth.target_num_layers str]
train.py: error: unrecognized arguments: 
usage: train.py [-h] [--config_path str] [--work_dir str] [--resume_from str]
                [--load_from str] [--debug str] [--caching str]
                [--report_to str] [--tracker_project_name str] [--name str]
                [--loss_report_name str] [--data.data_dir str]
                [--data.caption_proportion str]
                [--data.external_caption_suffixes str]
                [--data.external_clipscore_suffixes str]
                [--data.clip_thr_temperature str] [--data.clip_thr str]
                [--data.del_img_clip_thr str] [--data.sort_dataset str]
                [--data.load_text_feat str] [--data.load_vae_feat str]
                [--data.transform str] [--data.type str]
                [--data.image_size str] [--data.hq_only str]
                [--data.valid_num str] [--data.data str] [--data.extra str]
                [--model.model str] [--model.teacher str]
                [--model.image_size str] [--model.mixed_precision str]
                [--model.fp32_attention str] [--model.load_from str]
                [--model.discriminator_model str] [--model.teacher_model str]
                [--model.teacher_model_weight_dtype str]
                [--model.resume_from str] [--model.aspect_ratio_type str]
                [--model.multi_scale str] [--model.pe_interpolation str]
                [--model.micro_condition str] [--model.attn_type str]
                [--model.autocast_linear_attn str] [--model.ffn_type str]
                [--model.mlp_acts str] [--model.mlp_ratio str]
                [--model.use_pe str] [--model.pos_embed_type str]
                [--model.qk_norm str] [--model.class_dropout_prob str]
                [--model.linear_head_dim str] [--model.cross_norm str]
                [--model.cross_attn_type str] [--model.logvar str]
                [--model.cfg_scale str] [--model.cfg_embed str]
                [--model.cfg_embed_scale str] [--model.guidance_type str]
                [--model.pag_applied_layers str]
                [--model.ladd_multi_scale str] [--model.head_block_ids str]
                [--model.extra str] [--vae.vae_type str]
                [--vae.vae_pretrained str] [--vae.weight_dtype str]
                [--vae.scale_factor str] [--vae.vae_latent_dim str]
                [--vae.vae_downsample_rate str] [--vae.sample_posterior str]
                [--vae.extra str] [--text_encoder.text_encoder_name str]
                [--text_encoder.caption_channels str]
                [--text_encoder.y_norm str]
                [--text_encoder.y_norm_scale_factor str]
                [--text_encoder.model_max_length str]
                [--text_encoder.chi_prompt str] [--text_encoder.extra str]
                [--scheduler.train_sampling_steps str]
                [--scheduler.predict_flow_v str]
                [--scheduler.noise_schedule str] [--scheduler.pred_sigma str]
                [--scheduler.learn_sigma str] [--scheduler.vis_sampler str]
                [--scheduler.flow_shift str]
                [--scheduler.weighting_scheme str]
                [--scheduler.weighting_scheme_discriminator str]
                [--scheduler.add_noise_timesteps str]
                [--scheduler.logit_mean str] [--scheduler.logit_std str]
                [--scheduler.logit_mean_discriminator str]
                [--scheduler.logit_std_discriminator str]
                [--scheduler.sigma_data str]
                [--scheduler.timestep_norm_scale_factor str]
                [--scheduler.extra str] [--train.num_workers str]
                [--train.seed str] [--train.train_batch_size str]
                [--train.num_epochs str]
                [--train.gradient_accumulation_steps str]
                [--train.grad_checkpointing str] [--train.gradient_clip str]
                [--train.gc_step str] [--train.optimizer str]
                [--train.optimizer_D str] [--train.load_from_optimizer str]
                [--train.load_from_lr_scheduler str]
                [--train.resume_lr_scheduler str] [--train.lr_schedule str]
                [--train.lr_schedule_args str] [--train.auto_lr str]
                [--train.eval_batch_size str] [--train.use_fsdp str]
                [--train.use_flash_attn str] [--train.eval_sampling_steps str]
                [--train.lora_rank str] [--train.log_interval str]
                [--train.mask_type str] [--train.mask_loss_coef str]
                [--train.load_mask_index str] [--train.snr_loss str]
                [--train.real_prompt_ratio str] [--train.early_stop_hours str]
                [--train.save_image_epochs str]
                [--train.save_model_epochs str] [--train.save_model_steps str]
                [--train.visualize str] [--train.null_embed_root str]
                [--train.valid_prompt_embed_root str]
                [--train.validation_prompts str] [--train.local_save_vis str]
                [--train.deterministic_validation str]
                [--train.online_metric str] [--train.eval_metric_step str]
                [--train.online_metric_dir str] [--train.work_dir str]
                [--train.skip_step str] [--train.loss_type str]
                [--train.huber_c str] [--train.num_ddim_timesteps str]
                [--train.ema_decay str] [--train.debug_nan str]
                [--train.ema_update str] [--train.ema_rate str]
                [--train.tangent_warmup_steps str] [--train.scm_cfg_scale str]
                [--train.cfg_interval str] [--train.scm_logvar_loss str]
                [--train.norm_invariant_to_spatial_dim str]
                [--train.norm_same_as_512_scale str]
                [--train.g_norm_constant str] [--train.g_norm_r str]
                [--train.show_gradient str] [--train.lr_scale str]
                [--train.adv_lambda str] [--train.scm_loss str]
                [--train.scm_lambda str] [--train.loss_scale str]
                [--train.r1_penalty str] [--train.r1_penalty_weight str]
                [--train.diff_timesteps_D str]
                [--train.suffix_checkpoints str]
                [--train.misaligned_pairs_D str]
                [--train.discriminator_loss str]
                [--train.largest_timestep str]
                [--train.train_largest_timestep str]
                [--train.largest_timestep_prob str] [--train.extra str]
                [--controlnet.control_signal_type str]
                [--controlnet.validation_scribble_maps str]
                [--model_growth.pretrained_ckpt_path str]
                [--model_growth.init_strategy str]
                [--model_growth.init_params str]
                [--model_growth.source_num_layers str]
                [--model_growth.target_num_layers str]
train.py: error: unrecognized arguments: 
usage: train.py [-h] [--config_path str] [--work_dir str] [--resume_from str]
                [--load_from str] [--debug str] [--caching str]
                [--report_to str] [--tracker_project_name str] [--name str]
                [--loss_report_name str] [--data.data_dir str]
                [--data.caption_proportion str]
                [--data.external_caption_suffixes str]
                [--data.external_clipscore_suffixes str]
                [--data.clip_thr_temperature str] [--data.clip_thr str]
                [--data.del_img_clip_thr str] [--data.sort_dataset str]
                [--data.load_text_feat str] [--data.load_vae_feat str]
                [--data.transform str] [--data.type str]
                [--data.image_size str] [--data.hq_only str]
                [--data.valid_num str] [--data.data str] [--data.extra str]
                [--model.model str] [--model.teacher str]
                [--model.image_size str] [--model.mixed_precision str]
                [--model.fp32_attention str] [--model.load_from str]
                [--model.discriminator_model str] [--model.teacher_model str]
                [--model.teacher_model_weight_dtype str]
                [--model.resume_from str] [--model.aspect_ratio_type str]
                [--model.multi_scale str] [--model.pe_interpolation str]
                [--model.micro_condition str] [--model.attn_type str]
                [--model.autocast_linear_attn str] [--model.ffn_type str]
                [--model.mlp_acts str] [--model.mlp_ratio str]
                [--model.use_pe str] [--model.pos_embed_type str]
                [--model.qk_norm str] [--model.class_dropout_prob str]
                [--model.linear_head_dim str] [--model.cross_norm str]
                [--model.cross_attn_type str] [--model.logvar str]
                [--model.cfg_scale str] [--model.cfg_embed str]
                [--model.cfg_embed_scale str] [--model.guidance_type str]
                [--model.pag_applied_layers str]
                [--model.ladd_multi_scale str] [--model.head_block_ids str]
                [--model.extra str] [--vae.vae_type str]
                [--vae.vae_pretrained str] [--vae.weight_dtype str]
                [--vae.scale_factor str] [--vae.vae_latent_dim str]
                [--vae.vae_downsample_rate str] [--vae.sample_posterior str]
                [--vae.extra str] [--text_encoder.text_encoder_name str]
                [--text_encoder.caption_channels str]
                [--text_encoder.y_norm str]
                [--text_encoder.y_norm_scale_factor str]
                [--text_encoder.model_max_length str]
                [--text_encoder.chi_prompt str] [--text_encoder.extra str]
                [--scheduler.train_sampling_steps str]
                [--scheduler.predict_flow_v str]
                [--scheduler.noise_schedule str] [--scheduler.pred_sigma str]
                [--scheduler.learn_sigma str] [--scheduler.vis_sampler str]
                [--scheduler.flow_shift str]
                [--scheduler.weighting_scheme str]
                [--scheduler.weighting_scheme_discriminator str]
                [--scheduler.add_noise_timesteps str]
                [--scheduler.logit_mean str] [--scheduler.logit_std str]
                [--scheduler.logit_mean_discriminator str]
                [--scheduler.logit_std_discriminator str]
                [--scheduler.sigma_data str]
                [--scheduler.timestep_norm_scale_factor str]
                [--scheduler.extra str] [--train.num_workers str]
                [--train.seed str] [--train.train_batch_size str]
                [--train.num_epochs str]
                [--train.gradient_accumulation_steps str]
                [--train.grad_checkpointing str] [--train.gradient_clip str]
                [--train.gc_step str] [--train.optimizer str]
                [--train.optimizer_D str] [--train.load_from_optimizer str]
                [--train.load_from_lr_scheduler str]
                [--train.resume_lr_scheduler str] [--train.lr_schedule str]
                [--train.lr_schedule_args str] [--train.auto_lr str]
                [--train.eval_batch_size str] [--train.use_fsdp str]
                [--train.use_flash_attn str] [--train.eval_sampling_steps str]
                [--train.lora_rank str] [--train.log_interval str]
                [--train.mask_type str] [--train.mask_loss_coef str]
                [--train.load_mask_index str] [--train.snr_loss str]
                [--train.real_prompt_ratio str] [--train.early_stop_hours str]
                [--train.save_image_epochs str]
                [--train.save_model_epochs str] [--train.save_model_steps str]
                [--train.visualize str] [--train.null_embed_root str]
                [--train.valid_prompt_embed_root str]
                [--train.validation_prompts str] [--train.local_save_vis str]
                [--train.deterministic_validation str]
                [--train.online_metric str] [--train.eval_metric_step str]
                [--train.online_metric_dir str] [--train.work_dir str]
                [--train.skip_step str] [--train.loss_type str]
                [--train.huber_c str] [--train.num_ddim_timesteps str]
                [--train.ema_decay str] [--train.debug_nan str]
                [--train.ema_update str] [--train.ema_rate str]
                [--train.tangent_warmup_steps str] [--train.scm_cfg_scale str]
                [--train.cfg_interval str] [--train.scm_logvar_loss str]
                [--train.norm_invariant_to_spatial_dim str]
                [--train.norm_same_as_512_scale str]
                [--train.g_norm_constant str] [--train.g_norm_r str]
                [--train.show_gradient str] [--train.lr_scale str]
                [--train.adv_lambda str] [--train.scm_loss str]
                [--train.scm_lambda str] [--train.loss_scale str]
                [--train.r1_penalty str] [--train.r1_penalty_weight str]
                [--train.diff_timesteps_D str]
                [--train.suffix_checkpoints str]
                [--train.misaligned_pairs_D str]
                [--train.discriminator_loss str]
                [--train.largest_timestep str]
                [--train.train_largest_timestep str]
                [--train.largest_timestep_prob str] [--train.extra str]
                [--controlnet.control_signal_type str]
                [--controlnet.validation_scribble_maps str]
                [--model_growth.pretrained_ckpt_path str]
                [--model_growth.init_strategy str]
                [--model_growth.init_params str]
                [--model_growth.source_num_layers str]
                [--model_growth.target_num_layers str]
train.py: error: unrecognized arguments: 
usage: train.py [-h] [--config_path str] [--work_dir str] [--resume_from str]
                [--load_from str] [--debug str] [--caching str]
                [--report_to str] [--tracker_project_name str] [--name str]
                [--loss_report_name str] [--data.data_dir str]
                [--data.caption_proportion str]
                [--data.external_caption_suffixes str]
                [--data.external_clipscore_suffixes str]
                [--data.clip_thr_temperature str] [--data.clip_thr str]
                [--data.del_img_clip_thr str] [--data.sort_dataset str]
                [--data.load_text_feat str] [--data.load_vae_feat str]
                [--data.transform str] [--data.type str]
                [--data.image_size str] [--data.hq_only str]
                [--data.valid_num str] [--data.data str] [--data.extra str]
                [--model.model str] [--model.teacher str]
                [--model.image_size str] [--model.mixed_precision str]
                [--model.fp32_attention str] [--model.load_from str]
                [--model.discriminator_model str] [--model.teacher_model str]
                [--model.teacher_model_weight_dtype str]
                [--model.resume_from str] [--model.aspect_ratio_type str]
                [--model.multi_scale str] [--model.pe_interpolation str]
                [--model.micro_condition str] [--model.attn_type str]
                [--model.autocast_linear_attn str] [--model.ffn_type str]
                [--model.mlp_acts str] [--model.mlp_ratio str]
                [--model.use_pe str] [--model.pos_embed_type str]
                [--model.qk_norm str] [--model.class_dropout_prob str]
                [--model.linear_head_dim str] [--model.cross_norm str]
                [--model.cross_attn_type str] [--model.logvar str]
                [--model.cfg_scale str] [--model.cfg_embed str]
                [--model.cfg_embed_scale str] [--model.guidance_type str]
                [--model.pag_applied_layers str]
                [--model.ladd_multi_scale str] [--model.head_block_ids str]
                [--model.extra str] [--vae.vae_type str]
                [--vae.vae_pretrained str] [--vae.weight_dtype str]
                [--vae.scale_factor str] [--vae.vae_latent_dim str]
                [--vae.vae_downsample_rate str] [--vae.sample_posterior str]
                [--vae.extra str] [--text_encoder.text_encoder_name str]
                [--text_encoder.caption_channels str]
                [--text_encoder.y_norm str]
                [--text_encoder.y_norm_scale_factor str]
                [--text_encoder.model_max_length str]
                [--text_encoder.chi_prompt str] [--text_encoder.extra str]
                [--scheduler.train_sampling_steps str]
                [--scheduler.predict_flow_v str]
                [--scheduler.noise_schedule str] [--scheduler.pred_sigma str]
                [--scheduler.learn_sigma str] [--scheduler.vis_sampler str]
                [--scheduler.flow_shift str]
                [--scheduler.weighting_scheme str]
                [--scheduler.weighting_scheme_discriminator str]
                [--scheduler.add_noise_timesteps str]
                [--scheduler.logit_mean str] [--scheduler.logit_std str]
                [--scheduler.logit_mean_discriminator str]
                [--scheduler.logit_std_discriminator str]
                [--scheduler.sigma_data str]
                [--scheduler.timestep_norm_scale_factor str]
                [--scheduler.extra str] [--train.num_workers str]
                [--train.seed str] [--train.train_batch_size str]
                [--train.num_epochs str]
                [--train.gradient_accumulation_steps str]
                [--train.grad_checkpointing str] [--train.gradient_clip str]
                [--train.gc_step str] [--train.optimizer str]
                [--train.optimizer_D str] [--train.load_from_optimizer str]
                [--train.load_from_lr_scheduler str]
                [--train.resume_lr_scheduler str] [--train.lr_schedule str]
                [--train.lr_schedule_args str] [--train.auto_lr str]
                [--train.eval_batch_size str] [--train.use_fsdp str]
                [--train.use_flash_attn str] [--train.eval_sampling_steps str]
                [--train.lora_rank str] [--train.log_interval str]
                [--train.mask_type str] [--train.mask_loss_coef str]
                [--train.load_mask_index str] [--train.snr_loss str]
                [--train.real_prompt_ratio str] [--train.early_stop_hours str]
                [--train.save_image_epochs str]
                [--train.save_model_epochs str] [--train.save_model_steps str]
                [--train.visualize str] [--train.null_embed_root str]
                [--train.valid_prompt_embed_root str]
                [--train.validation_prompts str] [--train.local_save_vis str]
                [--train.deterministic_validation str]
                [--train.online_metric str] [--train.eval_metric_step str]
                [--train.online_metric_dir str] [--train.work_dir str]
                [--train.skip_step str] [--train.loss_type str]
                [--train.huber_c str] [--train.num_ddim_timesteps str]
                [--train.ema_decay str] [--train.debug_nan str]
                [--train.ema_update str] [--train.ema_rate str]
                [--train.tangent_warmup_steps str] [--train.scm_cfg_scale str]
                [--train.cfg_interval str] [--train.scm_logvar_loss str]
                [--train.norm_invariant_to_spatial_dim str]
                [--train.norm_same_as_512_scale str]
                [--train.g_norm_constant str] [--train.g_norm_r str]
                [--train.show_gradient str] [--train.lr_scale str]
                [--train.adv_lambda str] [--train.scm_loss str]
                [--train.scm_lambda str] [--train.loss_scale str]
                [--train.r1_penalty str] [--train.r1_penalty_weight str]
                [--train.diff_timesteps_D str]
                [--train.suffix_checkpoints str]
                [--train.misaligned_pairs_D str]
                [--train.discriminator_loss str]
                [--train.largest_timestep str]
                [--train.train_largest_timestep str]
                [--train.largest_timestep_prob str] [--train.extra str]
                [--controlnet.control_signal_type str]
                [--controlnet.validation_scribble_maps str]
                [--model_growth.pretrained_ckpt_path str]
                [--model_growth.init_strategy str]
                [--model_growth.init_params str]
                [--model_growth.source_num_layers str]
                [--model_growth.target_num_layers str]
train.py: error: unrecognized arguments: 
W0415 00:43:15.224000 2897777 site-packages/torch/distributed/elastic/multiprocessing/api.py:897] Sending process 2897939 closing signal SIGTERM
W0415 00:43:15.224000 2897777 site-packages/torch/distributed/elastic/multiprocessing/api.py:897] Sending process 2897943 closing signal SIGTERM
W0415 00:43:15.224000 2897777 site-packages/torch/distributed/elastic/multiprocessing/api.py:897] Sending process 2897944 closing signal SIGTERM
W0415 00:43:15.224000 2897777 site-packages/torch/distributed/elastic/multiprocessing/api.py:897] Sending process 2897946 closing signal SIGTERM
W0415 00:43:15.324000 1207412 site-packages/torch/distributed/elastic/multiprocessing/api.py:897] Sending process 1207498 closing signal SIGTERM
W0415 00:43:15.324000 1207412 site-packages/torch/distributed/elastic/multiprocessing/api.py:897] Sending process 1207499 closing signal SIGTERM
W0415 00:43:15.325000 1207412 site-packages/torch/distributed/elastic/multiprocessing/api.py:897] Sending process 1207500 closing signal SIGTERM
W0415 00:43:15.325000 1207412 site-packages/torch/distributed/elastic/multiprocessing/api.py:897] Sending process 1207501 closing signal SIGTERM
W0415 00:43:15.325000 1207412 site-packages/torch/distributed/elastic/multiprocessing/api.py:897] Sending process 1207502 closing signal SIGTERM
W0415 00:43:15.325000 1207412 site-packages/torch/distributed/elastic/multiprocessing/api.py:897] Sending process 1207503 closing signal SIGTERM
W0415 00:43:15.325000 1207412 site-packages/torch/distributed/elastic/multiprocessing/api.py:897] Sending process 1207505 closing signal SIGTERM
E0415 00:43:15.739000 2897777 site-packages/torch/distributed/elastic/multiprocessing/api.py:869] failed (exitcode: 2) local_rank: 1 (pid: 2897940) of binary: /lustre/fsw/portfolios/nvr/users/wenkunh/workspace/anaconda3/envs/dcae/bin/python
I0415 00:43:15.746000 2897777 site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py:368] ('local_rank %s FAILED with no error file. Decorate your entrypoint fn with @record for traceback info. See: https://pytorch.org/docs/stable/elastic/errors.html', 1)
Traceback (most recent call last):
  File "/lustre/fsw/portfolios/nvr/users/wenkunh/workspace/anaconda3/envs/dcae/bin/torchrun", line 8, in <module>
    sys.exit(main())
  File "/lustre/fsw/portfolios/nvr/users/wenkunh/workspace/anaconda3/envs/dcae/lib/python3.10/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py", line 355, in wrapper
    return f(*args, **kwargs)
  File "/lustre/fsw/portfolios/nvr/users/wenkunh/workspace/anaconda3/envs/dcae/lib/python3.10/site-packages/torch/distributed/run.py", line 918, in main
    run(args)
  File "/lustre/fsw/portfolios/nvr/users/wenkunh/workspace/anaconda3/envs/dcae/lib/python3.10/site-packages/torch/distributed/run.py", line 909, in run
    elastic_launch(
  File "/lustre/fsw/portfolios/nvr/users/wenkunh/workspace/anaconda3/envs/dcae/lib/python3.10/site-packages/torch/distributed/launcher/api.py", line 138, in __call__
    return launch_agent(self._config, self._entrypoint, list(args))
  File "/lustre/fsw/portfolios/nvr/users/wenkunh/workspace/anaconda3/envs/dcae/lib/python3.10/site-packages/torch/distributed/launcher/api.py", line 269, in launch_agent
    raise ChildFailedError(
torch.distributed.elastic.multiprocessing.errors.ChildFailedError: 
============================================================
train_scripts.train FAILED
------------------------------------------------------------
Failures:
[1]:
  time      : 2025-04-15_00:43:15
  host      : cw-dfw-h100-004-276-012.cm.cluster
  rank      : 2 (local_rank: 2)
  exitcode  : 2 (pid: 2897941)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
[2]:
  time      : 2025-04-15_00:43:15
  host      : cw-dfw-h100-004-276-012.cm.cluster
  rank      : 3 (local_rank: 3)
  exitcode  : 2 (pid: 2897942)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
[3]:
  time      : 2025-04-15_00:43:15
  host      : cw-dfw-h100-004-276-012.cm.cluster
  rank      : 6 (local_rank: 6)
  exitcode  : 2 (pid: 2897945)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
------------------------------------------------------------
Root Cause (first observed failure):
[0]:
  time      : 2025-04-15_00:43:15
  host      : cw-dfw-h100-004-276-012.cm.cluster
  rank      : 1 (local_rank: 1)
  exitcode  : 2 (pid: 2897940)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
============================================================
E0415 00:43:16.003000 1207412 site-packages/torch/distributed/elastic/multiprocessing/api.py:869] failed (exitcode: 2) local_rank: 6 (pid: 1207504) of binary: /lustre/fsw/portfolios/nvr/users/wenkunh/workspace/anaconda3/envs/dcae/bin/python
srun: error: cw-dfw-h100-004-276-012: task 0: Exited with exit code 1
srun: Terminating StepId=2395950.1
[W415 00:43:16.418563849 TCPStore.cpp:115] [c10d] recvVector failed on SocketImpl(fd=3, addr=[cw-dfw-h100-004-280-026.cm.cluster]:63958, remote=[cw-dfw-h100-004-276-012.cm.cluster]:29500): failed to recv, got 0 bytes
Exception raised from recvBytes at /pytorch/torch/csrc/distributed/c10d/Utils.hpp:671 (most recent call first):
frame #0: c10::Error::Error(c10::SourceLocation, std::string) + 0x96 (0x155553f6c1b6 in /lustre/fsw/portfolios/nvr/users/wenkunh/workspace/anaconda3/envs/dcae/lib/python3.10/site-packages/torch/lib/libc10.so)
frame #1: <unknown function> + 0x6311918 (0x15553c8e4918 in /lustre/fsw/portfolios/nvr/users/wenkunh/workspace/anaconda3/envs/dcae/lib/python3.10/site-packages/torch/lib/libtorch_cpu.so)
frame #2: <unknown function> + 0x6311f39 (0x15553c8e4f39 in /lustre/fsw/portfolios/nvr/users/wenkunh/workspace/anaconda3/envs/dcae/lib/python3.10/site-packages/torch/lib/libtorch_cpu.so)
frame #3: <unknown function> + 0x6314e57 (0x15553c8e7e57 in /lustre/fsw/portfolios/nvr/users/wenkunh/workspace/anaconda3/envs/dcae/lib/python3.10/site-packages/torch/lib/libtorch_cpu.so)
frame #4: c10d::TCPStore::compareSet(std::string const&, std::vector<unsigned char, std::allocator<unsigned char> > const&, std::vector<unsigned char, std::allocator<unsigned char> > const&) + 0x24c (0x15553c8e17bc in /lustre/fsw/portfolios/nvr/users/wenkunh/workspace/anaconda3/envs/dcae/lib/python3.10/site-packages/torch/lib/libtorch_cpu.so)
frame #5: <unknown function> + 0xe14425 (0x15554c4a3425 in /lustre/fsw/portfolios/nvr/users/wenkunh/workspace/anaconda3/envs/dcae/lib/python3.10/site-packages/torch/lib/libtorch_python.so)
frame #6: <unknown function> + 0x518d37 (0x15554bba7d37 in /lustre/fsw/portfolios/nvr/users/wenkunh/workspace/anaconda3/envs/dcae/lib/python3.10/site-packages/torch/lib/libtorch_python.so)
frame #7: /lustre/fsw/portfolios/nvr/users/wenkunh/workspace/anaconda3/envs/dcae/bin/python() [0x4fdcf7]
frame #8: _PyObject_MakeTpCall + 0x25b (0x4f747b in /lustre/fsw/portfolios/nvr/users/wenkunh/workspace/anaconda3/envs/dcae/bin/python)
frame #9: /lustre/fsw/portfolios/nvr/users/wenkunh/workspace/anaconda3/envs/dcae/bin/python() [0x509eda]
frame #10: _PyEval_EvalFrameDefault + 0x2b79 (0x4f0ca9 in /lustre/fsw/portfolios/nvr/users/wenkunh/workspace/anaconda3/envs/dcae/bin/python)
frame #11: _PyFunction_Vectorcall + 0x6f (0x4fe13f in /lustre/fsw/portfolios/nvr/users/wenkunh/workspace/anaconda3/envs/dcae/bin/python)
frame #12: _PyEval_EvalFrameDefault + 0x731 (0x4ee861 in /lustre/fsw/portfolios/nvr/users/wenkunh/workspace/anaconda3/envs/dcae/bin/python)
frame #13: _PyFunction_Vectorcall + 0x6f (0x4fe13f in /lustre/fsw/portfolios/nvr/users/wenkunh/workspace/anaconda3/envs/dcae/bin/python)
frame #14: _PyEval_EvalFrameDefault + 0x731 (0x4ee861 in /lustre/fsw/portfolios/nvr/users/wenkunh/workspace/anaconda3/envs/dcae/bin/python)
frame #15: _PyFunction_Vectorcall + 0x6f (0x4fe13f in /lustre/fsw/portfolios/nvr/users/wenkunh/workspace/anaconda3/envs/dcae/bin/python)
frame #16: _PyEval_EvalFrameDefault + 0x731 (0x4ee861 in /lustre/fsw/portfolios/nvr/users/wenkunh/workspace/anaconda3/envs/dcae/bin/python)
frame #17: _PyFunction_Vectorcall + 0x6f (0x4fe13f in /lustre/fsw/portfolios/nvr/users/wenkunh/workspace/anaconda3/envs/dcae/bin/python)
frame #18: _PyEval_EvalFrameDefault + 0x731 (0x4ee861 in /lustre/fsw/portfolios/nvr/users/wenkunh/workspace/anaconda3/envs/dcae/bin/python)
frame #19: _PyFunction_Vectorcall + 0x6f (0x4fe13f in /lustre/fsw/portfolios/nvr/users/wenkunh/workspace/anaconda3/envs/dcae/bin/python)
frame #20: _PyEval_EvalFrameDefault + 0x731 (0x4ee861 in /lustre/fsw/portfolios/nvr/users/wenkunh/workspace/anaconda3/envs/dcae/bin/python)
frame #21: _PyFunction_Vectorcall + 0x6f (0x4fe13f in /lustre/fsw/portfolios/nvr/users/wenkunh/workspace/anaconda3/envs/dcae/bin/python)
frame #22: _PyEval_EvalFrameDefault + 0x731 (0x4ee861 in /lustre/fsw/portfolios/nvr/users/wenkunh/workspace/anaconda3/envs/dcae/bin/python)
frame #23: /lustre/fsw/portfolios/nvr/users/wenkunh/workspace/anaconda3/envs/dcae/bin/python() [0x509a7e]
frame #24: _PyEval_EvalFrameDefault + 0x13b3 (0x4ef4e3 in /lustre/fsw/portfolios/nvr/users/wenkunh/workspace/anaconda3/envs/dcae/bin/python)
frame #25: _PyFunction_Vectorcall + 0x6f (0x4fe13f in /lustre/fsw/portfolios/nvr/users/wenkunh/workspace/anaconda3/envs/dcae/bin/python)
frame #26: _PyEval_EvalFrameDefault + 0x2b79 (0x4f0ca9 in /lustre/fsw/portfolios/nvr/users/wenkunh/workspace/anaconda3/envs/dcae/bin/python)
frame #27: _PyFunction_Vectorcall + 0x6f (0x4fe13f in /lustre/fsw/portfolios/nvr/users/wenkunh/workspace/anaconda3/envs/dcae/bin/python)
frame #28: _PyEval_EvalFrameDefault + 0x731 (0x4ee861 in /lustre/fsw/portfolios/nvr/users/wenkunh/workspace/anaconda3/envs/dcae/bin/python)
frame #29: _PyFunction_Vectorcall + 0x6f (0x4fe13f in /lustre/fsw/portfolios/nvr/users/wenkunh/workspace/anaconda3/envs/dcae/bin/python)
frame #30: _PyEval_EvalFrameDefault + 0x731 (0x4ee861 in /lustre/fsw/portfolios/nvr/users/wenkunh/workspace/anaconda3/envs/dcae/bin/python)
frame #31: _PyFunction_Vectorcall + 0x6f (0x4fe13f in /lustre/fsw/portfolios/nvr/users/wenkunh/workspace/anaconda3/envs/dcae/bin/python)
frame #32: _PyEval_EvalFrameDefault + 0x2b79 (0x4f0ca9 in /lustre/fsw/portfolios/nvr/users/wenkunh/workspace/anaconda3/envs/dcae/bin/python)
frame #33: _PyFunction_Vectorcall + 0x6f (0x4fe13f in /lustre/fsw/portfolios/nvr/users/wenkunh/workspace/anaconda3/envs/dcae/bin/python)
frame #34: _PyEval_EvalFrameDefault + 0x731 (0x4ee861 in /lustre/fsw/portfolios/nvr/users/wenkunh/workspace/anaconda3/envs/dcae/bin/python)
frame #35: _PyFunction_Vectorcall + 0x6f (0x4fe13f in /lustre/fsw/portfolios/nvr/users/wenkunh/workspace/anaconda3/envs/dcae/bin/python)
frame #36: _PyEval_EvalFrameDefault + 0x31f (0x4ee44f in /lustre/fsw/portfolios/nvr/users/wenkunh/workspace/anaconda3/envs/dcae/bin/python)
frame #37: _PyObject_FastCallDictTstate + 0xcd (0x4f67cd in /lustre/fsw/portfolios/nvr/users/wenkunh/workspace/anaconda3/envs/dcae/bin/python)
frame #38: _PyObject_Call_Prepend + 0xe0 (0x507fe0 in /lustre/fsw/portfolios/nvr/users/wenkunh/workspace/anaconda3/envs/dcae/bin/python)
frame #39: /lustre/fsw/portfolios/nvr/users/wenkunh/workspace/anaconda3/envs/dcae/bin/python() [0x5d0153]
frame #40: PyObject_Call + 0x209 (0x50a6f9 in /lustre/fsw/portfolios/nvr/users/wenkunh/workspace/anaconda3/envs/dcae/bin/python)
frame #41: _PyEval_EvalFrameDefault + 0x2b79 (0x4f0ca9 in /lustre/fsw/portfolios/nvr/users/wenkunh/workspace/anaconda3/envs/dcae/bin/python)
frame #42: _PyFunction_Vectorcall + 0x6f (0x4fe13f in /lustre/fsw/portfolios/nvr/users/wenkunh/workspace/anaconda3/envs/dcae/bin/python)
frame #43: _PyEval_EvalFrameDefault + 0x31f (0x4ee44f in /lustre/fsw/portfolios/nvr/users/wenkunh/workspace/anaconda3/envs/dcae/bin/python)
frame #44: _PyFunction_Vectorcall + 0x6f (0x4fe13f in /lustre/fsw/portfolios/nvr/users/wenkunh/workspace/anaconda3/envs/dcae/bin/python)
frame #45: _PyEval_EvalFrameDefault + 0x2b79 (0x4f0ca9 in /lustre/fsw/portfolios/nvr/users/wenkunh/workspace/anaconda3/envs/dcae/bin/python)
frame #46: _PyFunction_Vectorcall + 0x6f (0x4fe13f in /lustre/fsw/portfolios/nvr/users/wenkunh/workspace/anaconda3/envs/dcae/bin/python)
frame #47: _PyEval_EvalFrameDefault + 0x31f (0x4ee44f in /lustre/fsw/portfolios/nvr/users/wenkunh/workspace/anaconda3/envs/dcae/bin/python)
frame #48: /lustre/fsw/portfolios/nvr/users/wenkunh/workspace/anaconda3/envs/dcae/bin/python() [0x5953a2]
frame #49: PyEval_EvalCode + 0x87 (0x5952e7 in /lustre/fsw/portfolios/nvr/users/wenkunh/workspace/anaconda3/envs/dcae/bin/python)
frame #50: /lustre/fsw/portfolios/nvr/users/wenkunh/workspace/anaconda3/envs/dcae/bin/python() [0x5c6737]
frame #51: /lustre/fsw/portfolios/nvr/users/wenkunh/workspace/anaconda3/envs/dcae/bin/python() [0x5c1870]
frame #52: /lustre/fsw/portfolios/nvr/users/wenkunh/workspace/anaconda3/envs/dcae/bin/python() [0x459839]
frame #53: _PyRun_SimpleFileObject + 0x19f (0x5bbdff in /lustre/fsw/portfolios/nvr/users/wenkunh/workspace/anaconda3/envs/dcae/bin/python)
frame #54: _PyRun_AnyFileObject + 0x43 (0x5bbb63 in /lustre/fsw/portfolios/nvr/users/wenkunh/workspace/anaconda3/envs/dcae/bin/python)
frame #55: Py_RunMain + 0x38d (0x5b891d in /lustre/fsw/portfolios/nvr/users/wenkunh/workspace/anaconda3/envs/dcae/bin/python)
frame #56: Py_BytesMain + 0x39 (0x5885d9 in /lustre/fsw/portfolios/nvr/users/wenkunh/workspace/anaconda3/envs/dcae/bin/python)
frame #57: <unknown function> + 0x29d90 (0x155555212d90 in /lib/x86_64-linux-gnu/libc.so.6)
frame #58: __libc_start_main + 0x80 (0x155555212e40 in /lib/x86_64-linux-gnu/libc.so.6)
frame #59: /lustre/fsw/portfolios/nvr/users/wenkunh/workspace/anaconda3/envs/dcae/bin/python() [0x58848e]

W0415 00:43:16.035000 1207412 site-packages/torch/distributed/elastic/agent/server/api.py:719] Received Signals.SIGTERM death signal, shutting down workers
[W415 00:43:16.433022630 TCPStore.cpp:106] [c10d] sendBytes failed on SocketImpl(fd=3, addr=[cw-dfw-h100-004-280-026.cm.cluster]:63958, remote=[cw-dfw-h100-004-276-012.cm.cluster]:29500): Broken pipe
Exception raised from sendBytes at /pytorch/torch/csrc/distributed/c10d/Utils.hpp:646 (most recent call first):
frame #0: c10::Error::Error(c10::SourceLocation, std::string) + 0x96 (0x155553f6c1b6 in /lustre/fsw/portfolios/nvr/users/wenkunh/workspace/anaconda3/envs/dcae/lib/python3.10/site-packages/torch/lib/libc10.so)
frame #1: <unknown function> + 0x6311c1d (0x15553c8e4c1d in /lustre/fsw/portfolios/nvr/users/wenkunh/workspace/anaconda3/envs/dcae/lib/python3.10/site-packages/torch/lib/libtorch_cpu.so)
frame #2: c10d::TCPStore::compareSet(std::string const&, std::vector<unsigned char, std::allocator<unsigned char> > const&, std::vector<unsigned char, std::allocator<unsigned char> > const&) + 0x225 (0x15553c8e1795 in /lustre/fsw/portfolios/nvr/users/wenkunh/workspace/anaconda3/envs/dcae/lib/python3.10/site-packages/torch/lib/libtorch_cpu.so)
frame #3: <unknown function> + 0xe14425 (0x15554c4a3425 in /lustre/fsw/portfolios/nvr/users/wenkunh/workspace/anaconda3/envs/dcae/lib/python3.10/site-packages/torch/lib/libtorch_python.so)
frame #4: <unknown function> + 0x518d37 (0x15554bba7d37 in /lustre/fsw/portfolios/nvr/users/wenkunh/workspace/anaconda3/envs/dcae/lib/python3.10/site-packages/torch/lib/libtorch_python.so)
frame #5: /lustre/fsw/portfolios/nvr/users/wenkunh/workspace/anaconda3/envs/dcae/bin/python() [0x4fdcf7]
frame #6: _PyObject_MakeTpCall + 0x25b (0x4f747b in /lustre/fsw/portfolios/nvr/users/wenkunh/workspace/anaconda3/envs/dcae/bin/python)
frame #7: /lustre/fsw/portfolios/nvr/users/wenkunh/workspace/anaconda3/envs/dcae/bin/python() [0x509eda]
frame #8: _PyEval_EvalFrameDefault + 0x2b79 (0x4f0ca9 in /lustre/fsw/portfolios/nvr/users/wenkunh/workspace/anaconda3/envs/dcae/bin/python)
frame #9: _PyFunction_Vectorcall + 0x6f (0x4fe13f in /lustre/fsw/portfolios/nvr/users/wenkunh/workspace/anaconda3/envs/dcae/bin/python)
frame #10: _PyEval_EvalFrameDefault + 0x731 (0x4ee861 in /lustre/fsw/portfolios/nvr/users/wenkunh/workspace/anaconda3/envs/dcae/bin/python)
frame #11: _PyFunction_Vectorcall + 0x6f (0x4fe13f in /lustre/fsw/portfolios/nvr/users/wenkunh/workspace/anaconda3/envs/dcae/bin/python)
frame #12: _PyEval_EvalFrameDefault + 0x731 (0x4ee861 in /lustre/fsw/portfolios/nvr/users/wenkunh/workspace/anaconda3/envs/dcae/bin/python)
frame #13: _PyFunction_Vectorcall + 0x6f (0x4fe13f in /lustre/fsw/portfolios/nvr/users/wenkunh/workspace/anaconda3/envs/dcae/bin/python)
frame #14: _PyEval_EvalFrameDefault + 0x731 (0x4ee861 in /lustre/fsw/portfolios/nvr/users/wenkunh/workspace/anaconda3/envs/dcae/bin/python)
frame #15: _PyFunction_Vectorcall + 0x6f (0x4fe13f in /lustre/fsw/portfolios/nvr/users/wenkunh/workspace/anaconda3/envs/dcae/bin/python)
frame #16: _PyEval_EvalFrameDefault + 0x731 (0x4ee861 in /lustre/fsw/portfolios/nvr/users/wenkunh/workspace/anaconda3/envs/dcae/bin/python)
frame #17: _PyFunction_Vectorcall + 0x6f (0x4fe13f in /lustre/fsw/portfolios/nvr/users/wenkunh/workspace/anaconda3/envs/dcae/bin/python)
frame #18: _PyEval_EvalFrameDefault + 0x731 (0x4ee861 in /lustre/fsw/portfolios/nvr/users/wenkunh/workspace/anaconda3/envs/dcae/bin/python)
frame #19: _PyFunction_Vectorcall + 0x6f (0x4fe13f in /lustre/fsw/portfolios/nvr/users/wenkunh/workspace/anaconda3/envs/dcae/bin/python)
frame #20: _PyEval_EvalFrameDefault + 0x731 (0x4ee861 in /lustre/fsw/portfolios/nvr/users/wenkunh/workspace/anaconda3/envs/dcae/bin/python)
frame #21: _PyFunction_Vectorcall + 0x6f (0x4fe13f in /lustre/fsw/portfolios/nvr/users/wenkunh/workspace/anaconda3/envs/dcae/bin/python)
frame #22: _PyEval_EvalFrameDefault + 0x731 (0x4ee861 in /lustre/fsw/portfolios/nvr/users/wenkunh/workspace/anaconda3/envs/dcae/bin/python)
frame #23: _PyFunction_Vectorcall + 0x6f (0x4fe13f in /lustre/fsw/portfolios/nvr/users/wenkunh/workspace/anaconda3/envs/dcae/bin/python)
frame #24: _PyEval_EvalFrameDefault + 0x2b79 (0x4f0ca9 in /lustre/fsw/portfolios/nvr/users/wenkunh/workspace/anaconda3/envs/dcae/bin/python)
frame #25: _PyFunction_Vectorcall + 0x6f (0x4fe13f in /lustre/fsw/portfolios/nvr/users/wenkunh/workspace/anaconda3/envs/dcae/bin/python)
frame #26: _PyEval_EvalFrameDefault + 0x731 (0x4ee861 in /lustre/fsw/portfolios/nvr/users/wenkunh/workspace/anaconda3/envs/dcae/bin/python)
frame #27: _PyFunction_Vectorcall + 0x6f (0x4fe13f in /lustre/fsw/portfolios/nvr/users/wenkunh/workspace/anaconda3/envs/dcae/bin/python)
frame #28: _PyEval_EvalFrameDefault + 0x31f (0x4ee44f in /lustre/fsw/portfolios/nvr/users/wenkunh/workspace/anaconda3/envs/dcae/bin/python)
frame #29: _PyObject_FastCallDictTstate + 0xcd (0x4f67cd in /lustre/fsw/portfolios/nvr/users/wenkunh/workspace/anaconda3/envs/dcae/bin/python)
frame #30: _PyObject_Call_Prepend + 0xe0 (0x507fe0 in /lustre/fsw/portfolios/nvr/users/wenkunh/workspace/anaconda3/envs/dcae/bin/python)
frame #31: /lustre/fsw/portfolios/nvr/users/wenkunh/workspace/anaconda3/envs/dcae/bin/python() [0x5d0153]
frame #32: PyObject_Call + 0x209 (0x50a6f9 in /lustre/fsw/portfolios/nvr/users/wenkunh/workspace/anaconda3/envs/dcae/bin/python)
frame #33: _PyEval_EvalFrameDefault + 0x2b79 (0x4f0ca9 in /lustre/fsw/portfolios/nvr/users/wenkunh/workspace/anaconda3/envs/dcae/bin/python)
frame #34: _PyFunction_Vectorcall + 0x6f (0x4fe13f in /lustre/fsw/portfolios/nvr/users/wenkunh/workspace/anaconda3/envs/dcae/bin/python)
frame #35: _PyEval_EvalFrameDefault + 0x31f (0x4ee44f in /lustre/fsw/portfolios/nvr/users/wenkunh/workspace/anaconda3/envs/dcae/bin/python)
frame #36: _PyFunction_Vectorcall + 0x6f (0x4fe13f in /lustre/fsw/portfolios/nvr/users/wenkunh/workspace/anaconda3/envs/dcae/bin/python)
frame #37: _PyEval_EvalFrameDefault + 0x2b79 (0x4f0ca9 in /lustre/fsw/portfolios/nvr/users/wenkunh/workspace/anaconda3/envs/dcae/bin/python)
frame #38: _PyFunction_Vectorcall + 0x6f (0x4fe13f in /lustre/fsw/portfolios/nvr/users/wenkunh/workspace/anaconda3/envs/dcae/bin/python)
frame #39: _PyEval_EvalFrameDefault + 0x31f (0x4ee44f in /lustre/fsw/portfolios/nvr/users/wenkunh/workspace/anaconda3/envs/dcae/bin/python)
frame #40: /lustre/fsw/portfolios/nvr/users/wenkunh/workspace/anaconda3/envs/dcae/bin/python() [0x5953a2]
frame #41: PyEval_EvalCode + 0x87 (0x5952e7 in /lustre/fsw/portfolios/nvr/users/wenkunh/workspace/anaconda3/envs/dcae/bin/python)
frame #42: /lustre/fsw/portfolios/nvr/users/wenkunh/workspace/anaconda3/envs/dcae/bin/python() [0x5c6737]
frame #43: /lustre/fsw/portfolios/nvr/users/wenkunh/workspace/anaconda3/envs/dcae/bin/python() [0x5c1870]
frame #44: /lustre/fsw/portfolios/nvr/users/wenkunh/workspace/anaconda3/envs/dcae/bin/python() [0x459839]
frame #45: _PyRun_SimpleFileObject + 0x19f (0x5bbdff in /lustre/fsw/portfolios/nvr/users/wenkunh/workspace/anaconda3/envs/dcae/bin/python)
frame #46: _PyRun_AnyFileObject + 0x43 (0x5bbb63 in /lustre/fsw/portfolios/nvr/users/wenkunh/workspace/anaconda3/envs/dcae/bin/python)
frame #47: Py_RunMain + 0x38d (0x5b891d in /lustre/fsw/portfolios/nvr/users/wenkunh/workspace/anaconda3/envs/dcae/bin/python)
frame #48: Py_BytesMain + 0x39 (0x5885d9 in /lustre/fsw/portfolios/nvr/users/wenkunh/workspace/anaconda3/envs/dcae/bin/python)
frame #49: <unknown function> + 0x29d90 (0x155555212d90 in /lib/x86_64-linux-gnu/libc.so.6)
frame #50: __libc_start_main + 0x80 (0x155555212e40 in /lib/x86_64-linux-gnu/libc.so.6)
frame #51: /lustre/fsw/portfolios/nvr/users/wenkunh/workspace/anaconda3/envs/dcae/bin/python() [0x58848e]

W0415 00:43:16.039000 1207412 site-packages/torch/distributed/elastic/rendezvous/dynamic_rendezvous.py:1284] The node 'cw-dfw-h100-004-280-026.cm.cluster_1207412_0' has failed to shutdown the rendezvous '7678' due to an error of type RendezvousConnectionError.
Traceback (most recent call last):
  File "/lustre/fsw/portfolios/nvr/users/wenkunh/workspace/anaconda3/envs/dcae/lib/python3.10/site-packages/torch/distributed/elastic/rendezvous/c10d_rendezvous_backend.py", line 117, in _call_store
    return getattr(self._store, store_op)(*args, **kwargs)
torch.distributed.DistNetworkError: failed to recv, got 0 bytes

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/lustre/fsw/portfolios/nvr/users/wenkunh/workspace/anaconda3/envs/dcae/bin/torchrun", line 8, in <module>
    sys.exit(main())
  File "/lustre/fsw/portfolios/nvr/users/wenkunh/workspace/anaconda3/envs/dcae/lib/python3.10/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py", line 355, in wrapper
    return f(*args, **kwargs)
  File "/lustre/fsw/portfolios/nvr/users/wenkunh/workspace/anaconda3/envs/dcae/lib/python3.10/site-packages/torch/distributed/run.py", line 918, in main
    run(args)
  File "/lustre/fsw/portfolios/nvr/users/wenkunh/workspace/anaconda3/envs/dcae/lib/python3.10/site-packages/torch/distributed/run.py", line 909, in run
    elastic_launch(
  File "/lustre/fsw/portfolios/nvr/users/wenkunh/workspace/anaconda3/envs/dcae/lib/python3.10/site-packages/torch/distributed/launcher/api.py", line 138, in __call__
    return launch_agent(self._config, self._entrypoint, list(args))
  File "/lustre/fsw/portfolios/nvr/users/wenkunh/workspace/anaconda3/envs/dcae/lib/python3.10/site-packages/torch/distributed/launcher/api.py", line 260, in launch_agent
    result = agent.run()
  File "/lustre/fsw/portfolios/nvr/users/wenkunh/workspace/anaconda3/envs/dcae/lib/python3.10/site-packages/torch/distributed/elastic/metrics/api.py", line 137, in wrapper
    result = f(*args, **kwargs)
  File "/lustre/fsw/portfolios/nvr/users/wenkunh/workspace/anaconda3/envs/dcae/lib/python3.10/site-packages/torch/distributed/elastic/agent/server/api.py", line 711, in run
    result = self._invoke_run(role)
  File "/lustre/fsw/portfolios/nvr/users/wenkunh/workspace/anaconda3/envs/dcae/lib/python3.10/site-packages/torch/distributed/elastic/agent/server/api.py", line 901, in _invoke_run
    self._stop_workers(self._worker_group)
  File "/lustre/fsw/portfolios/nvr/users/wenkunh/workspace/anaconda3/envs/dcae/lib/python3.10/site-packages/torch/distributed/elastic/metrics/api.py", line 137, in wrapper
    result = f(*args, **kwargs)
  File "/lustre/fsw/portfolios/nvr/users/wenkunh/workspace/anaconda3/envs/dcae/lib/python3.10/site-packages/torch/distributed/elastic/agent/server/local_elastic_agent.py", line 286, in _stop_workers
    self._shutdown(is_restart=is_restart)
  File "/lustre/fsw/portfolios/nvr/users/wenkunh/workspace/anaconda3/envs/dcae/lib/python3.10/site-packages/torch/distributed/elastic/agent/server/local_elastic_agent.py", line 374, in _shutdown
    self._rdzv_handler.shutdown()
  File "/lustre/fsw/portfolios/nvr/users/wenkunh/workspace/anaconda3/envs/dcae/lib/python3.10/site-packages/torch/distributed/elastic/rendezvous/dynamic_rendezvous.py", line 1275, in shutdown
    self._close()
  File "/lustre/fsw/portfolios/nvr/users/wenkunh/workspace/anaconda3/envs/dcae/lib/python3.10/site-packages/torch/distributed/elastic/rendezvous/dynamic_rendezvous.py", line 1299, in _close
    self._op_executor.run(op, deadline)
  File "/lustre/fsw/portfolios/nvr/users/wenkunh/workspace/anaconda3/envs/dcae/lib/python3.10/site-packages/torch/distributed/elastic/rendezvous/dynamic_rendezvous.py", line 648, in run
    has_set = self._state_holder.sync()
  File "/lustre/fsw/portfolios/nvr/users/wenkunh/workspace/anaconda3/envs/dcae/lib/python3.10/site-packages/torch/distributed/elastic/rendezvous/dynamic_rendezvous.py", line 423, in sync
    set_response = self._backend.set_state(state_bits, self._token)
  File "/lustre/fsw/portfolios/nvr/users/wenkunh/workspace/anaconda3/envs/dcae/lib/python3.10/site-packages/torch/distributed/elastic/rendezvous/c10d_rendezvous_backend.py", line 100, in set_state
    base64_state: bytes = self._call_store(
  File "/lustre/fsw/portfolios/nvr/users/wenkunh/workspace/anaconda3/envs/dcae/lib/python3.10/site-packages/torch/distributed/elastic/rendezvous/c10d_rendezvous_backend.py", line 117, in _call_store
    return getattr(self._store, store_op)(*args, **kwargs)
  File "/lustre/fsw/portfolios/nvr/users/wenkunh/workspace/anaconda3/envs/dcae/lib/python3.10/site-packages/torch/distributed/elastic/multiprocessing/api.py", line 84, in _terminate_process_handler
    raise SignalException(f"Process {os.getpid()} got signal: {sigval}", sigval=sigval)
torch.distributed.elastic.multiprocessing.api.SignalException: Process 1207412 got signal: 15
srun: error: cw-dfw-h100-004-280-026: task 1: Exited with exit code 1
